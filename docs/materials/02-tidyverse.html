<!DOCTYPE html>
<html lang="en"><head>
<link href="..//images/logo.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.510">

  <meta name="author" content="Carlos Matos // ISPUP // November 2023">
  <title>Welcome to the  tidyverse</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #383a42;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #383a42; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #50a14f; } /* Annotation */
    code span.at { color: #a626a4; } /* Attribute */
    code span.bn { color: #986801; } /* BaseN */
    code span.bu { color: #a626a4; } /* BuiltIn */
    code span.cf { color: #a626a4; } /* ControlFlow */
    code span.ch { color: #50a14f; } /* Char */
    code span.cn { color: #986801; } /* Constant */
    code span.co { color: #a0a1a7; font-style: italic; } /* Comment */
    code span.cv { color: #e45649; font-style: italic; } /* CommentVar */
    code span.do { color: #e45649; } /* Documentation */
    code span.dt { color: #a626a4; } /* DataType */
    code span.dv { color: #986801; } /* DecVal */
    code span.er { color: #f44747; text-decoration: underline; } /* Error */
    code span.ex { color: #4078f2; font-weight: bold; } /* Extension */
    code span.fl { color: #986801; } /* Float */
    code span.fu { color: #4078f2; } /* Function */
    code span.im { color: #50a14f; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #a626a4; } /* Keyword */
    code span.op { color: #a626a4; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #a626a4; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #0184bc; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #50a14f; } /* String */
    code span.va { color: #e45649; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<meta property="og:title" content="Welcome to the  tidyverse">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Welcome to the <br> tidyverse</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://github.com/c-matos" style="color:#28a87d;font-weight:600;">Carlos Matos</a> // ISPUP // November 2023 
</div>
</div>
</div>

</section>
<section id="what-is-tidy-data" class="slide level2">
<h2>What is tidy data</h2>

<img data-src="img/tidy-quote.png" class="r-stretch quarto-figure-center"><p class="caption"><a href="https://r4ds.hadley.nz/data-tidy.html">https://r4ds.hadley.nz/data-tidy.html</a></p></section>
<section id="what-is-tidy-data-1" class="slide level2">
<h2>What is tidy data</h2>

<img data-src="img/hadley_tidydata.jpg" class="r-stretch quarto-figure-center"><p class="caption">What is tidy data</p></section>
<section id="what-is-tidy-data-2" class="slide level2">
<h2>What is tidy data</h2>

<img data-src="img/tidy-data1.png" class="r-stretch quarto-figure-center"><p class="caption">What is tidy data</p></section>
<section id="tidyverse-guiding-principles" class="slide level2">
<h2>Tidyverse guiding principles</h2>
<ul>
<li><p>It is <strong>human centered</strong>, i.e.&nbsp;the tidyverse is designed specifically to support the activities of a human data analyst.</p></li>
<li><p>It is <strong>consistent</strong>, so that what you learn about one function or package can be applied to another, and the number of special cases that you need to remember is as small as possible.</p></li>
<li><p>It is <strong>composable</strong>, allowing you to solve complex problems by breaking them down into small pieces, supporting a rapid cycle of exploratory iteration to find the best solution.</p></li>
<li><p>It is <strong>inclusive</strong>, because the tidyverse is not just the collection of packages, but it is also the community of people who use them.</p></li>
</ul>
<p><b class="simple-source"> <a href="https://design.tidyverse.org/unifying.html">https://design.tidyverse.org/unifying.html</a> </b></p>
</section>
<section id="data-science-workflow" class="slide level2">
<h2>Data Science workflow</h2>

<img data-src="img/ds_workflow.png" class="r-stretch quarto-figure-center"><p class="caption">Data science workflow</p><ul>
<li><strong>Model</strong> has its own tidy universe, called <a href="https://www.tidymodels.org/">tidymodels</a></li>
<li><strong>Communicate</strong> is done with other tools (Markdown, Quarto)</li>
</ul>
</section>
<section id="the-pipe" class="slide level2">
<h2>The pipe</h2>

<img data-src="img/pipes_in_r.png" class="r-stretch quarto-figure-center"><p class="caption">Pipes in R</p></section>
<section id="the-pipe-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The pipe</h2>
<div class=".columns">
<div class="column" style="width:40%;">
<p><img data-src="img/dplyr-pipe.png"></p>
</div>
<div class="column" style="width:59%;">
<p><img data-src="img/pipe2.png"></p>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb1-1" class="hljs-ln-code"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example code:</span></span>
<span id="cb1-2" class="hljs-ln-code"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb1-3" class="hljs-ln-code"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(study.group <span class="sc">==</span> <span class="st">"control"</span>)</span>
<span id="cb1-4" class="hljs-ln-code"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5" class="hljs-ln-code"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Equivalent to:</span></span>
<span id="cb1-6" class="hljs-ln-code"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(dat, study.group <span class="sc">==</span> <span class="st">"control"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-pipe-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The pipe</h2>
<div class=".columns">
<div class="column" style="width:40%;">
<p><img data-src="img/dplyr-pipe.png"></p>
</div>
<div class="column" style="width:59%;">
<p><img data-src="img/pipe2.png"></p>
</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb2-1" class="hljs-ln-code"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example code:</span></span>
<span id="cb2-2" class="hljs-ln-code"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb2-3" class="hljs-ln-code"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(study.group <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4" class="hljs-ln-code"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb2-5" class="hljs-ln-code"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6" class="hljs-ln-code"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Equivalent to:</span></span>
<span id="cb2-7" class="hljs-ln-code"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="fu">filter</span>(dat, study.group <span class="sc">==</span> <span class="st">"control"</span>), <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-pipe-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The pipe</h2>
<div class=".columns">
<div class="column" style="width:40%;">
<p><img data-src="img/dplyr-pipe.png"></p>
</div>
<div class="column" style="width:59%;">
<p><img data-src="img/pipe2.png"></p>
</div>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb3-1" class="hljs-ln-code"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example code:</span></span>
<span id="cb3-2" class="hljs-ln-code"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb3-3" class="hljs-ln-code"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(study.group <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4" class="hljs-ln-code"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_column =</span> <span class="st">"something"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5" class="hljs-ln-code"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb3-6" class="hljs-ln-code"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7" class="hljs-ln-code"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Equivalent to:</span></span>
<span id="cb3-8" class="hljs-ln-code"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="fu">mutate</span>(<span class="fu">filter</span>(dat, study.group <span class="sc">==</span> <span class="st">"control"</span>),new_colum <span class="sc">==</span> <span class="st">"something"</span>), <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-pipe-4" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The pipe</h2>
<p><br></p>
<ul>
<li>Easy to skim because verbs come at the start of each line</li>
<li>To add the pipe to your code you can use <code>Ctrl/Cmd</code> + <code>Shift</code> + <code>M</code></li>
<li>It is included in the core tidyverse</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb4-1" class="hljs-ln-code"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example code:</span></span>
<span id="cb4-2" class="hljs-ln-code"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">%&gt;%</span> </span>
<span id="cb4-3" class="hljs-ln-code"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(study.group <span class="sc">==</span> <span class="st">"control"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4" class="hljs-ln-code"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_column =</span> <span class="st">"something"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5" class="hljs-ln-code"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb4-6" class="hljs-ln-code"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7" class="hljs-ln-code"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Equivalent to:</span></span>
<span id="cb4-8" class="hljs-ln-code"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="fu">mutate</span>(<span class="fu">filter</span>(dat, study.group <span class="sc">==</span> <span class="st">"control"</span>),new_colum <span class="sc">==</span> <span class="st">"something"</span>), <span class="at">n =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="the-pipe-5" class="slide level2">
<h2>The pipe</h2>
<ul>
<li>Inside a pipe, you can refer to the previous output as <code>.</code> (dot)</li>
</ul>
<div class="question">
<p><strong>x %&gt;% f(y)</strong> <em>is the same as</em> <strong>f(x, y)</strong> <br> <strong>y %&gt;% f(x, ., z)</strong> is the same as <strong>f(x, y, z )</strong></p>
</div>
</section>
<section>
<section id="data-transformation" class="title-slide slide level1 center">
<h1>Data <br> <br> transformation</h1>

</section>
<section id="dplyr-to-the-rescue" class="slide level2">
<h2>dplyr to the rescue</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/dplyr2.png"></p>
<figcaption>dplyr hex sticker</figcaption>
</figure>
</div>
</div><div class="column" style="width:70%;">
<div>
<div class="question spaced-2">
<ul>
<li class="fragment"><p><span style="font-size:1.3em;"> First argument is <span class="simple-highlight-grn">always</span> a data frame </span></p></li>
<li class="fragment"><p><span style="font-size:1.3em;"> Other arguments (usually) are the <strong>names of the columns</strong> to operate on, <span class="simple-highlight-grn">without the quotes</span></span></p></li>
<li class="fragment"><p><span style="font-size:1.3em;"> The output is <span class="simple-highlight-grn">always</span> a new data frame</span></p></li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="dplyr-to-the-rescue-1" class="slide level2">
<h2>dplyr to the rescue</h2>
<p><br></p>
<p>dplyr’s verbs can be organized into groups, based on what they operate on:</p>
<p><span style="font-size:1.8em;font-family:Literata;"><b>  → <em>Rows</em></b> <span style="font-size:0.6em;"> (Change rows, w/o affecting columns)</span></span></p>
<p><span style="font-size:1.8em;font-family:Literata;"><b>  → <em>Columns</em></b> <span style="font-size:0.6em;"> (Change columns, w/o affecting rows )</span></span></p>
<p><span style="font-size:1.8em;font-family:Literata;"><b>  → <em>Groups</em></b></span></p>
<p><span style="font-size:1.8em;font-family:Literata;"><b>  → <em>Tables</em></b><em> </em></span></p>
</section></section>
<section>
<section id="rows" class="title-slide slide level1 center" data-background-color="#c4edff">
<h1><span style="line-height:.97;"> Rows </span></h1>

</section>
<section id="prerequisites" class="slide level2">
<h2>Prerequisites</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#loads the tidyverse functions</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder) <span class="co">#loads the gapminder dataset</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tibble with 1704 rows and 6 columns</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gapminder)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 6
$ country   &lt;fct&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan", …
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
$ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
$ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
$ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
</div>
</div>
</section>
<section id="sneak-peek-of-the-tidyverse" class="slide level2">
<h2>Sneak peek of the tidyverse</h2>
<ul>
<li>Calculating the gap in lifeExp by continent</li>
<li>The <strong>base R</strong> way</li>
</ul>
<div class="cell scrolling-400">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating the gap in lifeExp by continent</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>africa <span class="ot">&lt;-</span> gapminder[gapminder<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Africa"</span>, ]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>africa_mm <span class="ot">&lt;-</span> <span class="fu">max</span>(africa<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">min</span>(africa<span class="sc">$</span>lifeExp)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>americas <span class="ot">&lt;-</span> gapminder[gapminder<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Americas"</span>, ]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>americas_mm <span class="ot">&lt;-</span> <span class="fu">max</span>(americas<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">min</span>(americas<span class="sc">$</span>lifeExp)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>asia <span class="ot">&lt;-</span> gapminder[gapminder<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Asia"</span>, ]</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>asia_mm <span class="ot">&lt;-</span> <span class="fu">max</span>(asia<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">min</span>(africa<span class="sc">$</span>lifeExp)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>europe <span class="ot">&lt;-</span> gapminder[gapminder<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Europe"</span>, ]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>europe_mm <span class="ot">&lt;-</span> <span class="fu">max</span>(europe<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">min</span>(europe<span class="sc">$</span>lifeExp)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>oceania <span class="ot">&lt;-</span> gapminder[gapminder<span class="sc">$</span>continent <span class="sc">==</span> <span class="st">"Oceania"</span>, ]</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>oceania_mm <span class="ot">&lt;-</span> <span class="fu">max</span>(europe<span class="sc">$</span>lifeExp) <span class="sc">-</span> <span class="fu">min</span>(oceania<span class="sc">$</span>lifeExp)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">continent =</span> <span class="fu">c</span>(<span class="st">"Africa"</span>, <span class="st">"Asias"</span>, <span class="st">"Europe"</span>, <span class="st">"Oceania"</span>),</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_minus_min =</span> <span class="fu">c</span>(africa_mm, americas_mm, asia_mm, europe_mm, oceania_mm)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<ul>
<li>Prone to errors and hard to understand and debug</li>
</ul>
</section>
<section id="sneak-peek-of-the-tidyverse-output" class="slide level2 output-location-slide"><h2>Sneak peek of the tidyverse</h2><div class="cell scrolling-400 output-location-slide">
<div class="cell-output cell-output-stdout">
<pre><code>     continent max_minus_min
[1,] "Africa"  "52.843"     
[2,] "Asias"   "43.074"     
[3,] "Europe"  "59.004"     
[4,] "Oceania" "38.172"     
[5,] "Africa"  "12.637"     </code></pre>
</div>
</div></section><section id="sneak-peek-of-the-tidyverse-1" class="slide level2">
<h2>Sneak peek of the tidyverse</h2>
<ul>
<li>Calculating the gap in lifeExp by continent</li>
<li>The <strong>tidyverse</strong> way</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">summarize</span>(<span class="at">max_minus_min =</span> <span class="fu">max</span>(lifeExp) <span class="sc">-</span> <span class="fu">min</span>(lifeExp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent max_minus_min
  &lt;fct&gt;             &lt;dbl&gt;
1 Africa             52.8
2 Americas           43.1
3 Asia               53.8
4 Europe             38.2
5 Oceania            12.1</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter" class="slide level2">
<h2>Filter rows with filter()</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/filter-figure.png"></p>
<figcaption>Filter observations</figcaption>
</figure>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li><code>filter()</code> is used to <strong>subset</strong> observations based on their values</li>
<li>1<sup>st</sup> argument is the <em>name of the data frame</em></li>
<li>Other arguments are <strong>logical</strong> expressions that filter the data</li>
</ul>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>To check if A equals B we use the <strong>equality operator</strong> (<code>==</code>). <br> Not to be confused with the assignment operator (<code>=</code>).</p>
</div>
</div>
</div>
</section>
<section id="filter-rows-with-filter-1" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Portuguese data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Portugal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   country  continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Portugal Europe     1952    59.8  8526050     3068.
 2 Portugal Europe     1957    61.5  8817650     3775.
 3 Portugal Europe     1962    64.4  9019800     4728.
 4 Portugal Europe     1967    66.6  9103000     6362.
 5 Portugal Europe     1972    69.3  8970450     9022.
 6 Portugal Europe     1977    70.4  9662600    10172.
 7 Portugal Europe     1982    72.8  9859650    11754.
 8 Portugal Europe     1987    74.1  9915289    13039.
 9 Portugal Europe     1992    74.9  9927680    16207.
10 Portugal Europe     1997    76.0 10156415    17641.
11 Portugal Europe     2002    77.3 10433867    19971.
12 Portugal Europe     2007    78.1 10642836    20510.</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter-2" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Portuguese data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Equivalent to the previous code</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(gapminder, country <span class="sc">==</span> <span class="st">"Portugal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
   country  continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Portugal Europe     1952    59.8  8526050     3068.
 2 Portugal Europe     1957    61.5  8817650     3775.
 3 Portugal Europe     1962    64.4  9019800     4728.
 4 Portugal Europe     1967    66.6  9103000     6362.
 5 Portugal Europe     1972    69.3  8970450     9022.
 6 Portugal Europe     1977    70.4  9662600    10172.
 7 Portugal Europe     1982    72.8  9859650    11754.
 8 Portugal Europe     1987    74.1  9915289    13039.
 9 Portugal Europe     1992    74.9  9927680    16207.
10 Portugal Europe     1997    76.0 10156415    17641.
11 Portugal Europe     2002    77.3 10433867    19971.
12 Portugal Europe     2007    78.1 10642836    20510.</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter-3" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Portuguese data for the year 2007</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Portugal"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2007</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country  continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Portugal Europe     2007    78.1 10642836    20510.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternatively, using the and (&amp;) operator</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Portugal"</span> <span class="sc">&amp;</span> year <span class="sc">==</span> <span class="dv">2007</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  country  continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Portugal Europe     2007    78.1 10642836    20510.</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter-4" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Portuguese or Spanish data for the year 2007</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"Portugal"</span> <span class="sc">|</span> country <span class="sc">==</span> <span class="st">"Spain"</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2007</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  country  continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Portugal Europe     2007    78.1 10642836    20510.
2 Spain    Europe     2007    80.9 40448191    28821.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternatively, using the %in% operator</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Portugal"</span>,<span class="st">"Spain"</span>), </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>         year <span class="sc">==</span> <span class="dv">2007</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  country  continent  year lifeExp      pop gdpPercap
  &lt;fct&gt;    &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
1 Portugal Europe     2007    78.1 10642836    20510.
2 Spain    Europe     2007    80.9 40448191    28821.</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter-5" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>The <code>%in%</code> operator is very useful inside <code>filter()</code>, because it is easy to test different inputs. It allows single or multiple user selection. Using the <code>==</code> oeprator we would need to change the code everytime.</p>
</div>
</div>
</div>
<div class="panel-tabset scrolling-400">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Example 1</a></li><li><a href="#tabset-1-2">Example 2</a></li></ul>
<div class="tab-content scrolling-400">
<div id="tabset-1-1">
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="st">"Portugal"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#No need to change the chart code! Just the input fields above</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> countries) <span class="sc">%&gt;%</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> lifeExp, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="02-tidyverse_files/figure-revealjs/unnamed-chunk-8-1.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>countries <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Portugal"</span>,<span class="st">"Spain"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#No need to change the chart code! Just the input fields above</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> countries) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> lifeExp, </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="02-tidyverse_files/figure-revealjs/unnamed-chunk-9-1.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="filter-rows-with-filter-6" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<ul>
<li>Common <span class="simple-highlight-grn"> mistakes </span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="at">year =</span> <span class="dv">2007</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `filter()`:
! We detected a named input.
ℹ This usually means that you've used `=` instead of `==`.
ℹ Did you mean `year == 2007`?</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter-7" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<ul>
<li>Common <span class="simple-highlight-grn"> mistakes </span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Does not throw error, but does nothing</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># what happens is that R checks the condition (year == 2002) </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and then checks the condition 2007, which doesn't make sense</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2002</span> <span class="sc">|</span> <span class="dv">2007</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="filter-rows-with-filter-8" class="slide level2">
<h2>Filter rows with filter()</h2>
<p><br></p>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Challenge</a></li><li><a href="#tabset-2-2">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<blockquote>
Using the <code>airquality</code> dataset, filter only observations from <br> a) September, <br> b) for days that are multiples of five, <br> c) where temperature was above 80.
</blockquote>
</div>
<div id="tabset-2-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>airquality <span class="sc">%&gt;%</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">==</span> <span class="dv">9</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>         Day <span class="sc">%in%</span> <span class="fu">seq</span>(<span class="dv">5</span>,<span class="dv">30</span>,<span class="dv">5</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>         Temp <span class="sc">&gt;</span> <span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Ozone Solar.R Wind Temp Month Day
1    47      95  7.4   87     9   5
2    16     201  8.0   82     9  20</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arrange-rows-with-arrange" class="slide level2">
<h2>Arrange rows with arrange()</h2>
<ul>
<li><code>arrange()</code> changes the order of the rows based on the value of the columns (One or more)</li>
<li>The number of rows does not change</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Arrange/sort by year (oldest to newest - ascending)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Albania     Europe     1952    55.2  1282697     1601.
 3 Algeria     Africa     1952    43.1  9279525     2449.
 4 Angola      Africa     1952    30.0  4232095     3521.
 5 Argentina   Americas   1952    62.5 17876956     5911.
 6 Australia   Oceania    1952    69.1  8691212    10040.
 7 Austria     Europe     1952    66.8  6927772     6137.
 8 Bahrain     Asia       1952    50.9   120447     9867.
 9 Bangladesh  Asia       1952    37.5 46886859      684.
10 Belgium     Europe     1952    68    8730405     8343.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="arrange-rows-with-arrange-1" class="slide level2">
<h2>Arrange rows with arrange()</h2>
<ul>
<li><code>desc()</code> can be used inside <code>arrange()</code> to arrange descending</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Arrange/sort by year (newest to oldest - descending) </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(year))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
   country     continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       2007    43.8  31889923      975.
 2 Albania     Europe     2007    76.4   3600523     5937.
 3 Algeria     Africa     2007    72.3  33333216     6223.
 4 Angola      Africa     2007    42.7  12420476     4797.
 5 Argentina   Americas   2007    75.3  40301927    12779.
 6 Australia   Oceania    2007    81.2  20434176    34435.
 7 Austria     Europe     2007    79.8   8199783    36126.
 8 Bahrain     Asia       2007    75.6    708573    29796.
 9 Bangladesh  Asia       2007    64.1 150448339     1391.
10 Belgium     Europe     2007    79.4  10392226    33693.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="arrange-rows-with-arrange-2" class="slide level2">
<h2>Arrange rows with arrange()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Arrange/sort by continent (descending) and then by lifeExp (ascending)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(continent), lifeExp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Australia   Oceania    1952    69.1  8691212    10040.
 2 New Zealand Oceania    1952    69.4  1994794    10557.
 3 New Zealand Oceania    1957    70.3  2229407    12247.
 4 Australia   Oceania    1957    70.3  9712569    10950.
 5 Australia   Oceania    1962    70.9 10794968    12217.
 6 Australia   Oceania    1967    71.1 11872264    14526.
 7 New Zealand Oceania    1962    71.2  2488550    13176.
 8 New Zealand Oceania    1967    71.5  2728150    14464.
 9 New Zealand Oceania    1972    71.9  2929100    16046.
10 Australia   Oceania    1972    71.9 13177000    16789.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="arrange-rows-with-arrange-3" class="slide level2">
<h2>Arrange rows with arrange()</h2>
<p><br></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>When arranging a column that has <strong>NA</strong> values, they <strong>ALWAYS</strong> appear at the end of the dataset, whether the <code>arrange()</code> is ascending or descending. <br> When arranging by multiple columns, NAs will appear at the <strong>end of each group</strong>.</p>
</div>
</div>
</div>
</section>
<section id="arrange-rows-with-arrange-4" class="slide level2">
<h2>Arrange rows with arrange()</h2>
<p><br></p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Challenge</a></li><li><a href="#tabset-3-2">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<blockquote>
Using the <code>gapminder</code> dataset, show a data frame with the most recent year only, ordered by life expectancy (higher to lower)
</blockquote>
</div>
<div id="tabset-3-2">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(lifeExp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 6
   country          continent  year lifeExp       pop gdpPercap
   &lt;fct&gt;            &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;     &lt;dbl&gt;
 1 Japan            Asia       2007    82.6 127467972    31656.
 2 Hong Kong, China Asia       2007    82.2   6980412    39725.
 3 Iceland          Europe     2007    81.8    301931    36181.
 4 Switzerland      Europe     2007    81.7   7554661    37506.
 5 Australia        Oceania    2007    81.2  20434176    34435.
 6 Spain            Europe     2007    80.9  40448191    28821.
 7 Sweden           Europe     2007    80.9   9031088    33860.
 8 Israel           Asia       2007    80.7   6426679    25523.
 9 France           Europe     2007    80.7  61083916    30470.
10 Canada           Americas   2007    80.7  33390141    36319.
# ℹ 132 more rows</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="unique-values-with-distinct" class="slide level2">
<h2>Unique values with distinct()</h2>
<p><br></p>
<ul>
<li><code>distinct()</code> finds all the unique rows in a dataset.</li>
<li>Can be used for a single column or combination of columns.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get a list of unique/distinct years</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 142 × 1
   country    
   &lt;fct&gt;      
 1 Afghanistan
 2 Albania    
 3 Algeria    
 4 Angola     
 5 Argentina  
 6 Australia  
 7 Austria    
 8 Bahrain    
 9 Bangladesh 
10 Belgium    
# ℹ 132 more rows</code></pre>
</div>
</div>
</section>
<section id="unique-values-with-distinct-1" class="slide level2">
<h2>Unique values with distinct()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Get a distinct combination of continent + year</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(continent, year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 2
   continent  year
   &lt;fct&gt;     &lt;int&gt;
 1 Asia       1952
 2 Asia       1957
 3 Asia       1962
 4 Asia       1967
 5 Asia       1972
 6 Asia       1977
 7 Asia       1982
 8 Asia       1987
 9 Asia       1992
10 Asia       1997
# ℹ 50 more rows</code></pre>
</div>
</div>
</section>
<section id="unique-values-with-distinct-2" class="slide level2">
<h2>Unique values with distinct()</h2>
<p><br></p>
<ul>
<li>What if we want to keep the other columns?</li>
</ul>
<div class="cell custom-40-60 max-height-200 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(continent, year, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">.keep_all =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 6
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 50 more rows</code></pre>
</div>
</div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>Note that only one country remains for each continent! <br> The <code>.keep_all</code> argument only keeps the first row of values. <br> If you wanted to know how many countries were available for each continent/year combination, the <code>count()</code> function would work.</p>
</div>
</div>
</div>
</section>
<section id="count-rows-with-count" class="slide level2">
<h2>Count rows with count()</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#How many observations exist for each combination of continent + year?</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(continent, year) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 3
   continent  year     n
   &lt;fct&gt;     &lt;int&gt; &lt;int&gt;
 1 Africa     1952    52
 2 Africa     1957    52
 3 Africa     1962    52
 4 Africa     1967    52
 5 Africa     1972    52
 6 Africa     1977    52
 7 Africa     1982    52
 8 Africa     1987    52
 9 Africa     1992    52
10 Africa     1997    52
# ℹ 50 more rows</code></pre>
</div>
</div>
</section></section>
<section>
<section id="columns" class="title-slide slide level1 center" data-background-color="#c4edff">
<h1><span style="line-height:.97;"> Columns </span></h1>

</section>
<section id="select-columns-with-select" class="slide level2">
<h2>Select columns with select()</h2>
<p><br></p>
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/select-figure.png"></p>
<figcaption>Select columns</figcaption>
</figure>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li>Select or exclude columns</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select ONLY continent and lifeExp</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(continent, lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 2
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…</code></pre>
</div>
</div>
</section>
<section id="select-columns-with-select-1" class="slide level2">
<h2>Select columns with select()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select columns BETWEEN continent and lifeExp (inclusive)</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(continent<span class="sc">:</span>lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 3
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
$ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…</code></pre>
</div>
</div>
</section>
<section id="select-columns-with-select-2" class="slide level2">
<h2>Select columns with select()</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select columns EXCEPT those between continent and lifeExp (inclusive)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">!</span>continent<span class="sc">:</span>lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 3
$ country   &lt;fct&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan", …
$ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
$ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Previously <code>-</code> was used instead of <code>!</code> <br> When searching online for help you may still find answwers using <code>-</code></p>
</div>
</div>
</div>
</section>
<section id="select-columns-with-select-3" class="slide level2">
<h2>Select columns with select()</h2>
<p><br></p>
<ul>
<li>The tidyverse has some helper functions that can be used with <code>select()</code>, from the <code>tidyselect</code> package.</li>
<li>One example is the <code>where()</code> function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select only integer columns</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.integer)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 2
$ year &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, 2002,…
$ pop  &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 1288181…</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Note that <code>is.integer</code> is a function, and we are passing the <strong>function name</strong> as an argument of the <code>where()</code> function.</p>
</div>
</div>
</div>
</section>
<section id="select-columns-with-select-4" class="slide level2">
<h2>Select columns with select()</h2>
<p><br></p>
<ul>
<li>There are several selection helpers, which can be found in the tidyselect package <a href="https://tidyselect.r-lib.org/reference/index.html">vignette</a></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select only columns of type double</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.double)) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 2
$ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
$ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select columns that start with the letter "c"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">"c"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 2
$ country   &lt;fct&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan", …
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …</code></pre>
</div>
</div>
</section>
<section id="select-columns-with-select-5" class="slide level2">
<h2>Select columns with select()</h2>
<p><br></p>
<ul>
<li>You can <strong>reorder</strong> and/or <strong>rename</strong> columns as you select them</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Select three columns, while renaming one</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(continent,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">le =</span> lifeExp,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>         year) <span class="sc">%&gt;%</span> </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 3
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ le        &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
$ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …</code></pre>
</div>
</div>
</section>
<section id="rename-columns-with-rename" class="slide level2">
<h2>Rename columns with rename()</h2>
<p><br></p>
<ul>
<li><code>rename()</code> keeps all existing variables and allows you to rename a few</li>
<li>The syntax is <code>rename(.data, new_name = old_name)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rename lifeExp to le</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">le =</span> lifeExp) <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,704
Columns: 6
$ country   &lt;fct&gt; "Afghanistan", "Afghanistan", "Afghanistan", "Afghanistan", …
$ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
$ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
$ le        &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
$ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
$ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
</div>
</div>
</section>
<section id="rename-columns-with-janitorclean_names" class="slide level2">
<h2>Rename columns with janitor::clean_names()</h2>
<ul>
<li>For larger datasets with inconsistently named columns, the <code>clean_names()</code> function is a huge help</li>
<li>Suppose you have a gapminder dataset with inconsistent names</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>gapminder_crazy_names <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(Ç<span class="at">OUNTRY =</span> country,</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Continent =</span> continent,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">LifeExp =</span> lifeExp,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>         Ý<span class="at">ear =</span> year,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>         PÔP <span class="ot">=</span> pop,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">GDPPercap =</span> gdpPercap)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gapminder_crazy_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ÇOUNTRY"   "Continent" "Ýear"      "LifeExp"   "PÔP"       "GDPPercap"</code></pre>
</div>
</div>
</section>
<section id="rename-columns-with-janitorclean_names-1" class="slide level2">
<h2>Rename columns with janitor::clean_names()</h2>
<p><br></p>
<ul>
<li>Using <code>clean_names()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Suppose you have a gapminder dataset with inconsistent names</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gapminder_crazy_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ÇOUNTRY"   "Continent" "Ýear"      "LifeExp"   "PÔP"       "GDPPercap"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="co">#rename lifeExp to le</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>gapminder_crazy_names <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "country"    "continent"  "year"       "life_exp"   "pop"       
[6] "gdp_percap"</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The default output of <code>clean_names()</code> is lower case, with <code>_</code> separating words.</p>
</div>
</div>
</div>
</section>
<section id="move-columns-with-relocate" class="slide level2">
<h2>Move columns with relocate()</h2>
<p><br></p>
<ul>
<li><code>relocate()</code> moves variables around, without changing them</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make continent the first column</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(continent, <span class="at">.before =</span> country) <span class="sc">%&gt;%</span> <span class="co">#by var NAME </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "continent" "country"   "year"      "lifeExp"   "pop"       "gdpPercap"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(continent, <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co">#by var INDEX </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "continent" "country"   "year"      "lifeExp"   "pop"       "gdpPercap"</code></pre>
</div>
</div>
</section>
<section id="move-columns-with-relocate-1" class="slide level2" data-menu-title="tidyselect helpers inside relocate()">
<h2>Move columns with relocate()</h2>
<p><br></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>The tidyselect helpers we saw earlier can be used anywhere that we need to “select” a column.</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Move all columns that end with "p" to the right of country</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="fu">ends_with</span>(<span class="st">"p"</span>), <span class="at">.after =</span> country) <span class="sc">%&gt;%</span> <span class="co">#by var NAME </span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "country"   "lifeExp"   "pop"       "gdpPercap" "continent" "year"     </code></pre>
</div>
</div>
</section>
<section id="calculate-variables-with-mutate" class="slide level2">
<h2>Calculate variables with mutate()</h2>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-layout-panel" data-layout="[[-1], [1], [-1]]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure>
<p><img data-src="img/mutate-figure.png"></p>
<figcaption>mutate()</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:60%;">
<ul>
<li><code>mutate()</code> is used to add new columns, calculated from existing columns</li>
<li>By default columns are added to the right hand side of the dataset.</li>
</ul>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_millions =</span> pop <span class="sc">/</span> <span class="fl">1e6</span>,</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">total_gdp =</span> gdpPercap <span class="sc">*</span> pop) <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  country     continent  year lifeExp      pop gdpPercap pop_millions  total_gdp
  &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
1 Afghanistan Asia       1952    28.8  8425333      779.         8.43     6.57e9
2 Afghanistan Asia       1957    30.3  9240934      821.         9.24     7.59e9
3 Afghanistan Asia       1962    32.0 10267083      853.        10.3      8.76e9
4 Afghanistan Asia       1967    34.0 11537966      836.        11.5      9.65e9
5 Afghanistan Asia       1972    36.1 13079460      740.        13.1      9.68e9</code></pre>
</div>
</div>
</section>
<section id="calculate-variables-with-mutate-1" class="slide level2">
<h2>Calculate variables with mutate()</h2>
<p><br></p>
<blockquote>
<code>mutate()</code> is one of the most frequently used functions in a data analysis pipeline
</blockquote>
<ul>
<li>Mutate in itself is trivial, the hard part is often the logic/calculations that go into creating the desired columns</li>
</ul>
</section></section>
<section>
<section id="groups" class="title-slide slide level1 center" data-background-color="#c4edff">
<h1><span style="line-height:.97;"> Groups </span></h1>

</section>
<section id="grouped-subsets-with-group_by" class="slide level2">
<h2>Grouped subsets with group_by()</h2>
<p><br></p>
<div class=".columns">
<div class="column" style="width:40%;">
<p><img data-src="img/dplyr-group-by.png"></p>
</div>
<div class="column" style="width:59%;">
<ul>
<li><code>group_by()</code> divides a dataset into meaningful groups</li>
<li>Doesn’t change the underlying data</li>
<li>Subsequent operations will be performed <strong>by each group</strong></li>
</ul>
</div>
</div>
</section>
<section id="grouped-subsets-with-group_by-1" class="slide level2">
<h2>Grouped subsets with group_by()</h2>
<p><br></p>
<ul>
<li>looking closely at the output you see “# Groups: continent [5]”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group data by continent</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
# Groups:   continent [5]
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="grouped-subsets-with-group_by-2" class="slide level2">
<h2>Grouped subsets with group_by()</h2>
<p><br></p>
<ul>
<li>It’s possible to group by more than one variable simultaneously</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group data by continent and year</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent, year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 6
# Groups:   continent, year [60]
   country     continent  year lifeExp      pop gdpPercap
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.
 2 Afghanistan Asia       1957    30.3  9240934      821.
 3 Afghanistan Asia       1962    32.0 10267083      853.
 4 Afghanistan Asia       1967    34.0 11537966      836.
 5 Afghanistan Asia       1972    36.1 13079460      740.
 6 Afghanistan Asia       1977    38.4 14880372      786.
 7 Afghanistan Asia       1982    39.9 12881816      978.
 8 Afghanistan Asia       1987    40.8 13867957      852.
 9 Afghanistan Asia       1992    41.7 16317921      649.
10 Afghanistan Asia       1997    41.8 22227415      635.
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</section>
<section id="grouped-summaries-with-summarise" class="slide level2">
<h2>Grouped summaries with summarise()</h2>
<div class="columns">
<div class="column" style="width:30%;">
<div class="quarto-layout-panel" data-layout="[[-1], [1], [-1]]">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<p>&nbsp;</p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<figure>
<p><img data-src="img/summarise-figure.png"></p>
<figcaption>summarise()</figcaption>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<ul>
<li><code>summarise()</code><sup>1</sup> is the most important grouped operation</li>
<li>Reduces the data frame to a single row, or one row for each group, if used with <code>group_by()</code></li>
</ul>
</div>
</div>
<div class=".columns">
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mean gdpPercap, worldwide</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  mean_gdp
     &lt;dbl&gt;
1    7215.</code></pre>
</div>
</div>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mean gdpPercap, by continent</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent mean_gdp
  &lt;fct&gt;        &lt;dbl&gt;
1 Africa       2194.
2 Americas     7136.
3 Asia         7902.
4 Europe      14469.
5 Oceania     18622.</code></pre>
</div>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>or summarize</p></li></ol></aside></section>
<section id="grouped-summaries-with-summarise-1" class="slide level2">
<h2>Grouped summaries with summarise()</h2>
<p><br></p>
<ul>
<li>Multiple statistics/measures can be calculated inside <code>summarise()</code></li>
</ul>
<div class=".columns">
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mean gdpPercap, worldwide</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_pop =</span> <span class="fu">median</span>(pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
      n mean_gdp median_pop
  &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1  1704    7215.   7023596.</code></pre>
</div>
</div>
</div>
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#mean gdpPercap, by continent</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="co">#counts the number of rows</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_gdp =</span> <span class="fu">mean</span>(gdpPercap),</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_pop =</span> <span class="fu">median</span>(pop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  continent     n mean_gdp median_pop
  &lt;fct&gt;     &lt;int&gt;    &lt;dbl&gt;      &lt;dbl&gt;
1 Africa      624    2194.   4579311 
2 Americas    300    7136.   6227510 
3 Asia        396    7902.  14530830.
4 Europe      360   14469.   8551125 
5 Oceania      24   18622.   6403492.</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="grouped-summaries-with-summarise-2" class="slide level2">
<h2>Grouped summaries with summarise()</h2>
<p><br></p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p><span style="font-size:1.3em;">The <code>group_by()</code> and <code>summarise()</code> combination is frequently seen at the end of a pipeline. <br> A typical workflow would be: <br> Import data → select and rename relevant columns → clean and process the dataset → filter desired rows → compute new columns → group and summarise </span></p>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>When summarising a grouped data frame, the groups get <strong>dropped</strong> after the <code>summarise()</code> function call. However, other operations <strong>KEEP</strong> the groups by default.</p>
</div>
</div>
</div>
</section>
<section id="ungrouping-grouped-data-frames" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ungrouping grouped data frames</h2>
<p><br></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>When summarising a grouped data frame, the groups get <strong>dropped</strong> automatically after the <code>summarise()</code> function call. However, other operations <strong>KEEP</strong> the groups by default. To explicitly ungroup you can use the <code>ungroup()</code> function</p>
</div>
</div>
</div>
<div class="cell custom-40-60 max-height-200 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb89-1" class="hljs-ln-code"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create an ID column</span></span>
<span id="cb89-2" class="hljs-ln-code"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb89-3" class="hljs-ln-code"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4" class="hljs-ln-code"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,704 × 7
# Groups:   continent [5]
   country     continent  year lifeExp      pop gdpPercap    id
   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt; &lt;int&gt;
 1 Afghanistan Asia       1952    28.8  8425333      779.     1
 2 Afghanistan Asia       1957    30.3  9240934      821.     2
 3 Afghanistan Asia       1962    32.0 10267083      853.     3
 4 Afghanistan Asia       1967    34.0 11537966      836.     4
 5 Afghanistan Asia       1972    36.1 13079460      740.     5
 6 Afghanistan Asia       1977    38.4 14880372      786.     6
 7 Afghanistan Asia       1982    39.9 12881816      978.     7
 8 Afghanistan Asia       1987    40.8 13867957      852.     8
 9 Afghanistan Asia       1992    41.7 16317921      649.     9
10 Afghanistan Asia       1997    41.8 22227415      635.    10
# ℹ 1,694 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="ungrouping-grouped-data-frames-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Ungrouping grouped data frames</h2>
<p><br></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>When summarising a grouped data frame, the groups get <strong>dropped</strong> automatically after the <code>summarise()</code> function call. However, other operations <strong>KEEP</strong> the groups by default. To explicitly ungroup you can use the <code>ungroup()</code> function</p>
</div>
</div>
</div>
<div class="cell custom-40-60 max-height-200 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb91-1" class="hljs-ln-code"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create an ID column</span></span>
<span id="cb91-2" class="hljs-ln-code"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span> </span>
<span id="cb91-3" class="hljs-ln-code"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span> </span>
<span id="cb91-4" class="hljs-ln-code"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb91-5" class="hljs-ln-code"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(lifeExp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  continent  mean
  &lt;fct&gt;     &lt;dbl&gt;
1 Africa     48.9
2 Americas   64.7
3 Asia       60.1
4 Europe     71.9
5 Oceania    74.3</code></pre>
</div>
</div>
</div>
<ul>
<li>Note that the data frame is still grouped after the <code>mutate()</code> call, because the output of <code>summarise()</code> is given by continent.</li>
</ul>
</section></section>
<section>
<section id="tables" class="title-slide slide level1 center" data-background-color="#c4edff">
<h1><span style="line-height:.97;"> Tables </span></h1>

</section>
<section id="join-datasets-with-_join" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>Data analysis frequently involves multiple datasets.</li>
<li>Datasets must be joined somehow - some column or set of columns that are equal in both datasets</li>
<li>This common identifier is called a <strong>key</strong></li>
</ul>
<div class="question">
<p>There are two types of keys: a <strong>Primary key (PK)</strong> and a <strong>Foreign key (FK)</strong> <br><br> A <strong>Primary Key</strong> is a variable or set of variables that uniquely identifies each observation. <br> A <strong>Foreign Key</strong> is a variable or set of variables that correspond to a Primary Key in another table</p>
</div>
</section>
<section id="join-datasets-with-_join-1" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<div class=".columns">
<div class="column" style="width:40%;">
<p><img data-src="img/primary-key.png"></p>
</div>
<div class="column" style="width:59%;">
<div class="question">
<ul>
<li><strong>ID#</strong> is a PK in the Students table, and a FK in the Takes_Course table.</li>
<li><strong>ClassID</strong> is a PK in the Courses table, and a FK in the Takes_Course table.</li>
<li>The <strong>combination</strong> of <strong>ID# and ClassID</strong> is a PK in the Takes_Course table.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Foreign Keys can be repeated, while Primary Keys must be unique! <br> Note that R does not enforce by default this restriction. That burden falls to the user.</p>
</div>
</div>
</div>
</section>
<section id="join-datasets-with-_join-2" class="slide level2">
<h2>Join datasets with *_join()</h2>

<img data-src="img/types-of-joins.png" class="quarto-figure quarto-figure-center r-stretch" style="width:80.0%"></section>
<section id="join-datasets-with-_join-3" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>Consider the following datasets:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1) PT population in 2022 </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>pt_population <span class="sc">%&gt;%</span> glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 86
Columns: 3
$ year       &lt;int&gt; 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022,…
$ age        &lt;chr&gt; "75 anos", "83 anos", "3 anos", "2 anos", "6 anos", "16 ano…
$ population &lt;int&gt; 106539, 69073, 88015, 85532, 89039, 102837, 109057, 121978,…</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2) PT deaths in 2022</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>pt_deaths <span class="sc">%&gt;%</span> glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 119
Columns: 3
$ year   &lt;int&gt; 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 2022, 202…
$ age    &lt;chr&gt; "7 anos", "10 anos", "11 anos", "13 anos", "20 anos", "23 anos"…
$ deaths &lt;int&gt; 4, 4, 9, 12, 47, 44, 215, 433, 555, 3649, 4694, 132, 15, 34, 77…</code></pre>
</div>
</div>
</section>
<section id="join-datasets-with-_join-4" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<blockquote>
What column or columns do you consider the Primary Key in each table? How could we join them?
</blockquote>
</section>
<section id="join-datasets-with-_join-5" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<div class="question">
<ul>
<li><code>left_join()</code> allows you to combine two datasets</li>
<li>The output will have the same rows as x, the dataframe to which you are joining “external” data</li>
<li>If a value of x is not found on y, an <code>NA</code> is introduced</li>
</ul>
</div>
</section>
<section id="join-datasets-with-_join-6" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>In this case the column “year” is non-informative, because it has always the same value, therefore we only need to join by age</li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Join deaths data to the population dataset, by age</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>pt_population <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="at">x =</span> .,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> pt_deaths,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"age"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>  year.x     age population year.y deaths
1   2022 75 anos     106539   2022   2498
2   2022 83 anos      69073   2022   4500
3   2022  3 anos      88015   2022     22
4   2022  2 anos      85532   2022     15
5   2022  6 anos      89039   2022     14</code></pre>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Since both datasets had a column named year, that was not part of “by” condition, the output of <code>left_join()</code> adds a “.x” and “.y” suffix to each of the columns so that we know their origin. In this case they always have the same values, but that might not be the case in other situations.</p>
</div>
</div>
</div>
</section>
<section id="join-datasets-with-_join-7" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>Generally, it would be recommended to join by age and year simultaneously.</li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Join deaths data to the population dataset, by age and year</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>pt_population <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="at">x =</span> .,</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> pt_deaths,</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"age"</span>,<span class="st">"year"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>  year     age population deaths
1 2022 75 anos     106539   2498
2 2022 83 anos      69073   4500
3 2022  3 anos      88015     22
4 2022  2 anos      85532     15
5 2022  6 anos      89039     14</code></pre>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>In this scenario the “year” variable is part of the “by” condition, therefore only a single “year” column exists in the output and no “.x” and “.y” columns are created.</p>
</div>
</div>
</div>
</section>
<section id="join-datasets-with-_join-8" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>What if the columns to join by <strong>didn’t have</strong> the same name in both datasets?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rename the year variable to showcase this scenario</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>pt_deaths <span class="ot">&lt;-</span> pt_deaths <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">YEAR =</span> year)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pt_deaths)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "YEAR"   "age"    "deaths"</code></pre>
</div>
</div>
</section>
<section id="join-datasets-with-_join-9" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>What if the columns to join by <strong>didn’t have</strong> the same name in both datasets?</li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb103" data-code-line-numbers="6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="co">#Join deaths data to the population dataset, by age and year</span></span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="co">#year and YEAR have different names in each dataset</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>pt_population <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="#cb103-4"></a>  <span class="fu">left_join</span>(<span class="at">x =</span> .,</span>
<span id="cb103-5"><a href="#cb103-5"></a>            <span class="at">y =</span> pt_deaths,</span>
<span id="cb103-6"><a href="#cb103-6"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"age"</span>,<span class="st">"year"</span> <span class="ot">=</span> <span class="st">"YEAR"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-7"><a href="#cb103-7"></a>  <span class="fu">head</span>(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>  year     age population deaths
1 2022 75 anos     106539   2498
2 2022 83 anos      69073   4500
3 2022  3 anos      88015     22
4 2022  2 anos      85532     15
5 2022  6 anos      89039     14</code></pre>
</div>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>When variable names differ you need to specify “var_in_x” = “var_in_y” for the variables with different names.</p>
</div>
</div>
</div>
</section>
<section id="join-datasets-with-_join-10" class="slide level2">
<h2>Join datasets with *_join()</h2>
<p><br></p>
<ul>
<li>Using the last example, check if any NAs were introduced</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">#assign the last calculation to a variable</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>pt_full_data <span class="ot">&lt;-</span> pt_population <span class="sc">%&gt;%</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="at">x =</span> .,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> pt_deaths,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"age"</span>,<span class="st">"year"</span> <span class="ot">=</span> <span class="st">"YEAR"</span>))</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Show rows that have NA in any cell</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>pt_full_data <span class="sc">%&gt;%</span> </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_any</span>(<span class="fu">everything</span>(),is.na))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  year            age population deaths
1 2022 85 e mais anos     368400     NA
2 2022          0 ano      83727     NA</code></pre>
</div>
</div>
<blockquote>
Why were those NA introduced? Could NA be introduced in any other column during the <code>left_join()</code>?
</blockquote>
</section>
<section id="getting-help" class="slide level2">
<h2>Getting help</h2>
<p><a href="https://posit.co/resources/cheatsheets/">Posit cheatsheets</a></p>

<img data-src="img/dplyr_sheet.png" class="r-stretch quarto-figure-center"><p class="caption">dplyr cheatsheet</p></section>
<section id="tidying-data-with-tidyr" class="slide level2">
<h2>Tidying data with tidyr</h2>
<p><br></p>
<ul>
<li>There are multiple ways to represent the same data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
   year   age variable   value
  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;int&gt;
1  2022     1 population 79975
2  2022     1 deaths        15
3  2022     2 population 85532
4  2022     2 deaths        15
5  2022     3 population 88015
6  2022     3 deaths        22
7  2022     4 population 88463
8  2022     4 deaths         9</code></pre>
</div>
</div>
<blockquote>
Is this dataset tidy? Why?
</blockquote>
</section>
<section id="tidying-data-with-tidyr-1" class="slide level2">
<h2>Tidying data with tidyr</h2>
<p><br></p>
<ul>
<li>There are multiple ways to represent the same data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>table2 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
   year   age death_rate
  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;     
1  2022     1 15/79975  
2  2022     2 15/85532  
3  2022     3 22/88015  
4  2022     4 9/88463   
5  2022     5 6/87918   
6  2022     6 14/89039  
7  2022     7 4/87372   
8  2022     8 10/84277  </code></pre>
</div>
</div>
<blockquote>
Is this dataset tidy? Why?
</blockquote>
</section>
<section id="tidying-data-with-tidyr-2" class="slide level2">
<h2>Tidying data with tidyr</h2>
<p><br></p>
<ul>
<li>There are multiple ways to represent the same data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
   year   age population deaths
  &lt;int&gt; &lt;dbl&gt;      &lt;int&gt;  &lt;int&gt;
1  2022     1      79975     15
2  2022     2      85532     15
3  2022     3      88015     22
4  2022     4      88463      9
5  2022     5      87918      6
6  2022     6      89039     14
7  2022     7      87372      4
8  2022     8      84277     10</code></pre>
</div>
</div>
<blockquote>
Is this dataset tidy? Why?
</blockquote>
</section>
<section id="tidying-data-with-tidyr-3" class="slide level2">
<h2>Tidying data with tidyr</h2>
<p><br></p>
<div class="question">
<ul>
<li>Most built-in R functions work with vectors.</li>
<li>Tidy data allows R’s vectorized nature to shine.</li>
</ul>
</div>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>table3 <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">death_rate =</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>           deaths <span class="sc">/</span> population <span class="sc">*</span> <span class="fl">1e5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 84 × 5
    year   age population deaths death_rate
   &lt;int&gt; &lt;dbl&gt;      &lt;int&gt;  &lt;int&gt;      &lt;dbl&gt;
 1  2022     1      79975     15      18.8 
 2  2022     2      85532     15      17.5 
 3  2022     3      88015     22      25.0 
 4  2022     4      88463      9      10.2 
 5  2022     5      87918      6       6.82
 6  2022     6      89039     14      15.7 
 7  2022     7      87372      4       4.58
 8  2022     8      84277     10      11.9 
 9  2022     9      84561      3       3.55
10  2022    10      91241      4       4.38
# ℹ 74 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="tidying-data-with-tidyr-4" class="slide level2">
<h2>Tidying data with tidyr</h2>
<p><br></p>
<blockquote>
How would you calculate the death rate in <code>table1</code> and <code>table2</code>?
</blockquote>
<div class="question">
<ul>
<li>Real world data is often untidy.
<ul>
<li>Data is organized to facilitate some goal other than analysis (e.g.&nbsp;entry, display in wide screens)</li>
</ul></li>
<li>Most data science projects will require some level of tidying prior to analysis.</li>
</ul>
</div>
</section>
<section id="lengthening-data-with-pivot_longer" class="slide level2">
<h2>Lengthening data with pivot_longer()</h2>
<p><br></p>
<ul>
<li>The following dataset shows the plasma concentrations of Indomethacin over 11 periods of time, for 6 subjects.</li>
<li>This way of presenting data (<strong>Wide format</strong>) is frequently seen in repeated measures studies or time series data.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>indometh_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
  Subject t0.25  t0.5 t0.75    t1 t1.25    t2    t3    t4    t5    t6    t8
  &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1        1.5   0.94  0.78  0.48  0.37  0.19  0.12  0.11  0.08  0.07  0.05
2 2        2.03  1.63  0.71  0.7   0.64  0.36  0.32  0.2   0.25  0.12  0.08
3 3        2.72  1.49  1.16  0.8   0.8   0.39  0.22  0.12  0.11  0.08  0.08
4 4        1.85  1.39  1.02  0.89  0.59  0.4   0.16  0.11  0.1   0.07  0.07
5 5        2.05  1.04  0.81  0.39  0.3   0.23  0.13  0.11  0.08  0.1   0.06
6 6        2.31  1.44  1.03  0.84  0.64  0.42  0.24  0.17  0.13  0.1   0.09</code></pre>
</div>
</div>
</section>
<section id="lengthening-data-with-pivot_longer-1" class="slide level2">
<h2>Lengthening data with pivot_longer()</h2>
<p><br></p>
<ul>
<li>The <code>pivot_longer()</code> function takes three key arguments
<ul>
<li><code>cols</code> specifies the columns that need to be pivoted. Uses the same syntax as <code>select()</code></li>
<li><code>names_to</code> names the variable stored in the column names</li>
<li><code>values_to</code> names the variable stored in the cell values</li>
</ul></li>
</ul>
<div id="fig-tidy-data" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-tidy-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tidy-data" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-tidy1" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-tidy1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="img/tidy-data1.png" data-ref-parent="fig-tidy-data">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-tidy1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Existing columns get repeated
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tidy-data" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-tidy2" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-tidy2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="img/tidy-data2.png" data-ref-parent="fig-tidy-data">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-tidy2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Names go to a new column
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-tidy-data" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-tidy3" class="quarto-figure quarto-figure-center">
<figure class="quarto-float quarto-subfloat-fig">
<div aria-describedby="fig-tidy3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img data-src="img/tidy-data3.png" data-ref-parent="fig-tidy-data">
</div>
<figcaption class="figure quarto-subfloat-caption quarto-subfloat-fig" id="fig-tidy3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Values are preserved, row by row
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="figure quarto-float-caption quarto-float-fig" id="fig-tidy-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: How does pivoting work?
</figcaption>
</figure>
</div>
</section>
<section id="lengthening-data-with-pivot_longer-2" class="slide level2">
<h2>Lengthening data with pivot_longer()</h2>
<p><br></p>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb117" data-code-line-numbers="1-6|11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>indometh_wide <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb117-3"><a href="#cb117-3"></a>    <span class="at">cols =</span> <span class="sc">-</span>Subject, <span class="co">#All except Subject</span></span>
<span id="cb117-4"><a href="#cb117-4"></a>    <span class="at">names_to =</span> <span class="st">"time"</span>, </span>
<span id="cb117-5"><a href="#cb117-5"></a>    <span class="at">values_to =</span> <span class="st">"plasma_conc"</span></span>
<span id="cb117-6"><a href="#cb117-6"></a>  )</span>
<span id="cb117-7"><a href="#cb117-7"></a></span>
<span id="cb117-8"><a href="#cb117-8"></a><span class="co">#Alternatively</span></span>
<span id="cb117-9"><a href="#cb117-9"></a>alt <span class="ot">&lt;-</span> indometh_wide <span class="sc">%&gt;%</span> </span>
<span id="cb117-10"><a href="#cb117-10"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb117-11"><a href="#cb117-11"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"t"</span>), <span class="co">#All that start with letter "t"</span></span>
<span id="cb117-12"><a href="#cb117-12"></a>    <span class="at">names_to =</span> <span class="st">"time"</span>, </span>
<span id="cb117-13"><a href="#cb117-13"></a>    <span class="at">values_to =</span> <span class="st">"plasma_conc"</span></span>
<span id="cb117-14"><a href="#cb117-14"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 66 × 3
   Subject time  plasma_conc
   &lt;ord&gt;   &lt;chr&gt;       &lt;dbl&gt;
 1 1       t0.25        1.5 
 2 1       t0.5         0.94
 3 1       t0.75        0.78
 4 1       t1           0.48
 5 1       t1.25        0.37
 6 1       t2           0.19
 7 1       t3           0.12
 8 1       t4           0.11
 9 1       t5           0.08
10 1       t6           0.07
# ℹ 56 more rows</code></pre>
</div>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>“time” and “plasma_conc” need to be in quotes because those are columns we are creating, they don’t exist yet in the dataset</p>
</div>
</div>
</div>
</section>
<section id="lengthening-data-with-pivot_longer-3" class="slide level2">
<h2>Lengthening data with pivot_longer()</h2>
<p><br></p>
<ul>
<li>If we wanted to remove the extra “t” in the time column, we could use the <code>parse_number()</code> function</li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb119" data-code-line-numbers="7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a>indometh_long <span class="ot">&lt;-</span> </span>
<span id="cb119-2"><a href="#cb119-2"></a>  indometh_wide <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb119-4"><a href="#cb119-4"></a>    <span class="at">cols =</span> <span class="sc">-</span>Subject,</span>
<span id="cb119-5"><a href="#cb119-5"></a>    <span class="at">names_to =</span> <span class="st">"time"</span>, </span>
<span id="cb119-6"><a href="#cb119-6"></a>    <span class="at">values_to =</span> <span class="st">"plasma_conc"</span></span>
<span id="cb119-7"><a href="#cb119-7"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb119-8"><a href="#cb119-8"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">parse_number</span>(time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">

</div>
</div>
</section>
<section id="lengthening-data-with-pivot_longer-4" class="slide level2">
<h2>Lengthening data with pivot_longer()</h2>
<p><br></p>
<ul>
<li>Now it would be much easier to plot the data with ggplot</li>
</ul>
<div class="cell custom-40-60 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>indometh_long <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> plasma_conc, </span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> Subject)) <span class="sc">+</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="02-tidyverse_files/figure-revealjs/unnamed-chunk-58-1.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="lengthening-data-with-pivot_longer-5" class="slide level2">
<h2>Lengthening data with pivot_longer()</h2>
<p><br></p>
<ul>
<li><code>pivot_longer()</code> can deal with multiple and more complex scenarios, such as:
<ul>
<li>Many variables in column names</li>
<li>Data and variable names in column headers <br><br></li>
</ul></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>You can explore these patterns in depth in the <a href="https://r4ds.hadley.nz/data-tidy">R for Data Science book</a></p>
</div>
</div>
</div>
</section>
<section id="widening-data-with-pivot_wider" class="slide level2">
<h2>Widening data with pivot_wider()</h2>
<ul>
<li>The opposite of pivot_longer() is <code>pivot_wider()</code>.</li>
<li>The <code>pivot_wider()</code> function takes two key arguments
<ul>
<li><code>names_from</code> names the variable that will be converted into column names</li>
<li><code>values_from</code> names the variable stored in the cell values</li>
</ul></li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Widening the subjects variable</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>Indometh <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Subject,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> conc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 7
    time   `1`   `2`   `3`   `4`   `5`   `6`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  0.25  1.5   2.03  2.72  1.85  2.05  2.31
 2  0.5   0.94  1.63  1.49  1.39  1.04  1.44
 3  0.75  0.78  0.71  1.16  1.02  0.81  1.03
 4  1     0.48  0.7   0.8   0.89  0.39  0.84
 5  1.25  0.37  0.64  0.8   0.59  0.3   0.64
 6  2     0.19  0.36  0.39  0.4   0.23  0.42
 7  3     0.12  0.32  0.22  0.16  0.13  0.24
 8  4     0.11  0.2   0.12  0.11  0.11  0.17
 9  5     0.08  0.25  0.11  0.1   0.08  0.13
10  6     0.07  0.12  0.08  0.07  0.1   0.1 
11  8     0.05  0.08  0.08  0.07  0.06  0.09</code></pre>
</div>
</div>
</div>
</section>
<section id="widening-data-with-pivot_wider-1" class="slide level2">
<h2>Widening data with pivot_wider()</h2>
<p><br></p>
<ul>
<li>Widening data could make sense at the end of a pipeline, for display purposes</li>
</ul>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>Indometh <span class="sc">%&gt;%</span> </span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Subject,</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> conc) <span class="sc">%&gt;%</span> </span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">14</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic_2</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<table class="table lightable-classic-2" data-quarto-postprocess="true" style="font-size: 14px; margin-left: auto; margin-right: auto; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">time</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">2.72</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">2.31</td>
</tr>
<tr class="even">
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">1.39</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">1.44</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">1.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.84</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.64</td>
</tr>
<tr class="even">
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.42</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.24</td>
</tr>
<tr class="even">
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.17</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.13</td>
</tr>
<tr class="even">
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.10</td>
</tr>
<tr class="odd">
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.09</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
</section></section>
<section>
<section id="importing-data-to-r" class="title-slide slide level1 center">
<h1>Importing <br><br> data to R</h1>

</section>
<section id="importing-data-to-r-1" class="slide level2">
<h2>Importing data to R</h2>
<p><br></p>
<ul>
<li>There are many data sources that R can read data from (e.g.&nbsp;Databases, JSON, geo data, …)</li>
<li>We will focus on <strong>tabular data</strong>. For most small scale projects, you will import data from:
<ul>
<li>Spreadsheets (csv, xls, xlsx, txt, google sheets)</li>
<li>Statistical software (spss, stata, sas)</li>
</ul></li>
<li>Tidyverse packages include
<ul>
<li>readr (txt, csv, tsv)</li>
<li>readxl (xls, xlsx)</li>
<li>haven (spss, sas, stata)</li>
</ul></li>
<li>Unsupported file formats (check supported formats <a href="https://cran.r-project.org/web/packages/rio/vignettes/rio.html#Data_Export">here</a>)</li>
</ul>
</section>
<section id="importing-data-to-r-2" class="slide level2">
<h2>Importing data to R</h2>
<p><br></p>
<div class="question">
<p>One {rio} to rule them all!</p>
</div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"filepath/filename.ext"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br> And that’s it…</p>
</section>
<section id="importing-data-to-r-3" class="slide level2">
<h2>Importing data to R</h2>
<p><br></p>
<h3 id="and-for-exporting">And for exporting</h3>
<div class="question">
<p>One {rio} to rule them all!</p>
</div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(my_awesome_object, <span class="st">"filepath/my_aesome_object.csv"</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(my_awesome_object, <span class="st">"filepath/my_aesome_object.xlsx"</span>)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(my_awesome_object, <span class="st">"filepath/my_aesome_object.sav"</span>)</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(my_awesome_object, <span class="st">"filepath/my_aesome_object.dta"</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>rio<span class="sc">::</span><span class="fu">export</span>(my_awesome_object, <span class="st">"filepath/my_aesome_object.rds"</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><br></p>
<p>Choose whatever file type you want <br> And that’s it.</p>
</section>
<section id="when-may-rio-not-be-enough" class="slide level2">
<h2>When may {rio} not be enough?</h2>
<ul>
<li>With Excel
<ul>
<li>Import from file with multiple sheets</li>
<li>Import multiple ranges separately</li>
<li><code>read_excel()</code> function from {readxl} has you covered</li>
</ul></li>
<li>With sources that may require authentication (e.g.&nbsp;googlesheets, onedrive)
<ul>
<li>Specific packages for these purposes (e.g.&nbsp;{googlesheets4})</li>
</ul></li>
</ul>
</section>
<section id="encoding-hell" class="slide level2">
<h2>Encoding hell</h2>
<p><br></p>
<ul>
<li>Sometimes when importing non-english text data you will get errors on characters such as ã, ô, ç, …</li>
<li><code>ASCII</code> (American Standard Code for Information Interchange) encoding, for example, does not include accented characters.</li>
<li><code>Latin1 (aka ISO-8859-1)</code> was used for Western European languages, and you may still find datasets with this encoding.</li>
<li>The most likely source of such errors are encoding differences.</li>
</ul>
</section>
<section id="encoding-hell-1" class="slide level2">
<h2>Encoding hell</h2>
<p><br></p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>The default encoding used almost everywhere today is <strong>UTF-8</strong>. <br><br> When encountering strange, unexpected, characters in text data one of the first thing you should think about are <strong>encoding differences!</strong> <br><br> When naming things (variables, files, folders, …), <strong>avoid non-english characters</strong> to save you trouble down the line!</p>
</div>
</div>
</div>
<ul>
<li>RStudio allows you to open R scripts with a specific encoding, when it’s different from the default.</li>
</ul>
</section>
<section id="learning-how-to-learn" class="slide level2">
<h2>Learning how to learn</h2>
<ul>
<li>Check the <strong>function documentation</strong> and examples</li>
<li>Check the package <strong>vignettes</strong> and <strong>articles</strong></li>
<li><strong>Google it!</strong>
<ul>
<li>You will likely end up on <strong>Stackoverflow</strong>…</li>
</ul></li>
<li><strong>ChatGPT</strong>
<ul>
<li>Useful, but beware of allucinations (e.g.&nbsp;functions or packages that do not exist)</li>
</ul></li>
</ul>
</section>
<section id="learning-how-to-learn-1" class="slide level2">
<h2>Learning how to learn</h2>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>When googling, ask for <em>tidyverse</em> solutions: <br> An example: <br> <strong>What you want to know:</strong> How to filter only observations that have the pattern “abc” in the “Name” variable, in a dataframe called “my_awesome_dataframe” <br> <strong>What you would ask:</strong> “Tidyverse how to filter observations that have a specific pattern” <br> <strong>What you would ask:</strong> “Tidyverse how to filter observations based on a substring” <br><br> Google the idea/pattern (filtering rows based on a substring of text), instead of the specific pattern that you are looking for.</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="some-useful-functions-and-patterns" class="title-slide slide level1 center">
<h1>Some useful<br><br> functions and <br><br>patterns</h1>

</section>
<section id="making-numbers-from-text" class="slide level2">
<h2>Making numbers from text</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"$1,234"</span>, <span class="st">"EUR 9,876"</span>, <span class="st">"0.5g/l"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">parse_number</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1234.0 9876.0    0.5</code></pre>
</div>
</div>
</section>
<section id="rounding-numbers" class="slide level2">
<h2>Rounding numbers</h2>
<p><br></p>
<ul>
<li>Very useful when plotting or displaying data in a table</li>
<li>Scales package works neatly with ggplot with functions <code>label_*</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>many_decimals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.13435435</span>, <span class="fl">3.1415926</span>)</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>many_decimals <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">number</span>(<span class="at">accuracy =</span> <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1.13" "3.14"</code></pre>
</div>
</div>
</section>
<section id="cutting-numbers-into-ranges" class="slide level2">
<h2>Cutting numbers into ranges</h2>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>ages <span class="sc">%&gt;%</span> <span class="fu">cut_interval</span>(<span class="at">length =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] [0,5]    (5,10]   (10,15]  (15,20]  (20,25]  (25,30]  (30,35]  (35,40] 
 [9] (40,45]  (45,50]  (50,55]  (55,60]  (60,65]  (65,70]  (70,75]  (75,80] 
[17] (80,85]  (85,90]  (90,95]  (95,100]
20 Levels: [0,5] (5,10] (10,15] (15,20] (20,25] (25,30] (30,35] ... (95,100]</code></pre>
</div>
</div>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Challenge</a></li><li><a href="#tabset-4-2">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<blockquote>
<p>What if we wanted to store the results in a tibble, with the columns “age” and “age_groups”, and have a group “85+” for all the ages &gt;85?</p>
</blockquote>
</div>
<div id="tabset-4-2">
<div class="scrolling-200">
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-overflow-scroll code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>age_groups_df <span class="ot">&lt;-</span> ages <span class="sc">%&gt;%</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_groups =</span> <span class="fu">cut_interval</span>(ages, <span class="at">length =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_groups =</span> <span class="fu">fct_collapse</span>(age_groups, </span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"85+"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"(85,90]"</span>, <span class="st">"(90,95]"</span>, <span class="st">"(95,100]"</span>)))</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a><span class="co">#With fct_collapse we can specify a group that we want to create based on other levels, </span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="co">#and all the other groups remain the same</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Alternatively</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>age_groups_df <span class="ot">&lt;-</span> ages <span class="sc">%&gt;%</span> </span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> value) <span class="sc">%&gt;%</span> </span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_helper =</span> <span class="fu">ifelse</span>(age<span class="sc">&gt;</span><span class="dv">85</span>,<span class="dv">86</span>,age)) <span class="sc">%&gt;%</span> </span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_groups =</span> <span class="fu">cut_interval</span>(age_helper, <span class="at">length =</span> <span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_groups =</span> <span class="fu">if_else</span>(age_groups <span class="sc">==</span> <span class="st">"(85,90]"</span>,</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">factor</span>(<span class="st">"85+"</span>),</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>                              age_groups))</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a><span class="co">#In this approach we are converting all values greater than 85 to a value</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a><span class="co">#in that range, so that the cut_interval only generated one extra group,</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="co">#that can then be converted to the desired format with if_else</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="offset-values" class="slide level2">
<h2>Offset values</h2>
<ul>
<li>Useful to calculate variations with regularly intervaled data (e.g.&nbsp;year-over-year changes)</li>
<li>The <code>lag(value, n)</code> functions searches for the <em>value</em> in the same col, <em>n</em> rows above</li>
<li>If the dataset is properly arranged/sorted, this pattern can be used to calculate change in time series datasets</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">#A dataset with monthly values for Portugal and World</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 96
Columns: 4
$ year       &lt;int&gt; 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020,…
$ month      &lt;int&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 1…
$ region     &lt;chr&gt; "Portugal", "World", "Portugal", "World", "Portugal", "Worl…
$ some_value &lt;dbl&gt; 1.53070845, 1.24319833, -0.71736323, -0.61063213, 0.1250573…</code></pre>
</div>
</div>
</section>
<section id="offset-values-1" class="slide level2">
<h2>Offset values</h2>
<ul>
<li>The <code>lag(value, n)</code> functions searches for the <em>value</em>, <em>n</em> rows <strong>above</strong></li>
<li>The <code>lead(value, n)</code> functions searches for the <em>value</em>, <em>n</em> rows <strong>below</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculating Year-over-Year (YoY) changes (e.g. yoy = 12/2023 - 12/2022)</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(region,year,month) <span class="sc">%&gt;%</span> </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(region) <span class="sc">%&gt;%</span> </span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yoy =</span> some_value <span class="sc">-</span> <span class="fu">lag</span>(some_value,<span class="dv">12</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 96
Columns: 5
Groups: region [2]
$ year       &lt;int&gt; 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020, 2020,…
$ month      &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 1, 2, 3, 4, 5, 6, 7,…
$ region     &lt;chr&gt; "Portugal", "Portugal", "Portugal", "Portugal", "Portugal",…
$ some_value &lt;dbl&gt; 1.53070845, -0.71736323, 0.12505738, -0.49000543, 0.0203951…
$ yoy        &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, -0.7213474,…</code></pre>
</div>
</div>
</section></section>
<section>
<section id="strings" class="title-slide slide level1 center">
<h1>Strings</h1>

</section>
<section id="str_-family-of-functions-with-stringr" class="slide level2">
<h2>str_* family of functions with {stringr}</h2>
<ul>
<li>There are some relevant functions to deal with strings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dataset from the gapminder package</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>country_codes <span class="sc">%&gt;%</span> glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 187
Columns: 3
$ country   &lt;chr&gt; "Afghanistan", "Albania", "Algeria", "Angola", "Argentina", …
$ iso_alpha &lt;chr&gt; "AFG", "ALB", "DZA", "AGO", "ARG", "ARM", "ABW", "AUS", "AUT…
$ iso_num   &lt;int&gt; 4, 8, 12, 24, 32, 51, 533, 36, 40, 31, 44, 48, 50, 52, 112, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Countries that start with P</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>country_codes <span class="sc">%&gt;%</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_starts</span>(country,<span class="st">"P"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 9
Columns: 3
$ country   &lt;chr&gt; "Pakistan", "Panama", "Papua New Guinea", "Paraguay", "Peru"…
$ iso_alpha &lt;chr&gt; "PAK", "PAN", "PNG", "PRY", "PER", "PHL", "POL", "PRT", "PRI"
$ iso_num   &lt;int&gt; 586, 591, 598, 600, 604, 608, 616, 620, 630</code></pre>
</div>
</div>
</section>
<section id="str_-family-of-functions-with-stringr-1" class="slide level2">
<h2>str_* family of functions with {stringr}</h2>
<ul>
<li>A few examples of relevant functions to deal with strings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Countries that contain "gal"</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>country_codes <span class="sc">%&gt;%</span> </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(country,<span class="st">"gal"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  country  iso_alpha iso_num
  &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt;
1 Portugal PRT           620
2 Senegal  SEN           686</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace all capital "A" with "!"</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>country_codes <span class="sc">%&gt;%</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">str_replace_all</span>(country, <span class="st">"A"</span>,<span class="st">"!"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 187
Columns: 3
$ country   &lt;chr&gt; "!fghanistan", "!lbania", "!lgeria", "!ngola", "!rgentina", …
$ iso_alpha &lt;chr&gt; "AFG", "ALB", "DZA", "AGO", "ARG", "ARM", "ABW", "AUS", "AUT…
$ iso_num   &lt;int&gt; 4, 8, 12, 24, 32, 51, 533, 36, 40, 31, 44, 48, 50, 52, 112, …</code></pre>
</div>
</div>
</section>
<section id="str_-family-of-functions-with-stringr-2" class="slide level2">
<h2>str_* family of functions with {stringr}</h2>
<ul>
<li>A few examples of relevant functions to deal with strings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace all "a" or "A" with "!"</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>country_codes <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">country =</span> <span class="fu">str_replace_all</span>(country, <span class="fu">regex</span>(<span class="st">"a"</span>, <span class="at">ignore_case=</span>T), <span class="st">"!"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 187
Columns: 3
$ country   &lt;chr&gt; "!fgh!nist!n", "!lb!ni!", "!lgeri!", "!ngol!", "!rgentin!", …
$ iso_alpha &lt;chr&gt; "AFG", "ALB", "DZA", "AGO", "ARG", "ARM", "ABW", "AUS", "AUT…
$ iso_num   &lt;int&gt; 4, 8, 12, 24, 32, 51, 533, 36, 40, 31, 44, 48, 50, 52, 112, …</code></pre>
</div>
</div>
</section>
<section id="str_-family-of-functions-with-stringr-3" class="slide level2">
<h2>str_* family of functions with {stringr}</h2>
<ul>
<li>A few examples of relevant functions to deal with strings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Split the character every time you find the letter "n"</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>country_codes<span class="sc">$</span>country <span class="sc">%&gt;%</span> <span class="fu">str_split</span>(<span class="st">"n"</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "Afgha" "ista"  ""     

[[2]]
[1] "Alba" "ia"  

[[3]]
[1] "Algeria"

[[4]]
[1] "A"    "gola"

[[5]]
[1] "Arge" "ti"   "a"   

[[6]]
[1] "Arme" "ia"  

[[7]]
[1] "Aruba"

[[8]]
[1] "Australia"

[[9]]
[1] "Austria"

[[10]]
[1] "Azerbaija" ""         </code></pre>
</div>
</div>
<ul>
<li>And many more…</li>
</ul>
</section>
<section id="separate_-family-of-functions" class="slide level2">
<h2>separate_* family of functions</h2>
<ul>
<li>Sometimes a column contains multiple value</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">year_month =</span> <span class="fu">c</span>(<span class="st">"2023-12"</span>, <span class="st">"2023-11"</span>, <span class="st">"2023-10"</span>),</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Jon Snow"</span>, <span class="st">"Arya Stark"</span>, <span class="st">"Tyrion Lannister"</span>),</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">some_value =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3
Columns: 3
$ year_month &lt;chr&gt; "2023-12", "2023-11", "2023-10"
$ name       &lt;chr&gt; "Jon Snow", "Arya Stark", "Tyrion Lannister"
$ some_value &lt;dbl&gt; 1, 2, 3</code></pre>
</div>
</div>
</section>
<section id="separate_-family-of-functions-1" class="slide level2">
<h2>separate_* family of functions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Separate year_month into two columns, by position</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">separate_wider_position</span>(year_month,</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">widths =</span> <span class="fu">c</span>(<span class="at">year =</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="at">month =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3
Columns: 4
$ year       &lt;chr&gt; "2023", "2023", "2023"
$ month      &lt;chr&gt; "12", "11", "10"
$ name       &lt;chr&gt; "Jon Snow", "Arya Stark", "Tyrion Lannister"
$ some_value &lt;dbl&gt; 1, 2, 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Separate name into first and last names, by delimiter</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">separate_wider_delim</span>(name,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">delim =</span> <span class="st">" "</span>,</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"first_name"</span>,<span class="st">"last_name"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3
Columns: 4
$ year_month &lt;chr&gt; "2023-12", "2023-11", "2023-10"
$ first_name &lt;chr&gt; "Jon", "Arya", "Tyrion"
$ last_name  &lt;chr&gt; "Snow", "Stark", "Lannister"
$ some_value &lt;dbl&gt; 1, 2, 3</code></pre>
</div>
</div>
</section>
<section id="glue" class="slide level2">
<h2>glue</h2>
<ul>
<li>Used to easily pass variables into strings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">year_month =</span> <span class="fu">c</span>(<span class="st">"2023-12"</span>, <span class="st">"2023-11"</span>, <span class="st">"2023-10"</span>),</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Jon Snow"</span>, <span class="st">"Arya Stark"</span>, <span class="st">"Tyrion Lannister"</span>),</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">some_value =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3
Columns: 3
$ year_month &lt;chr&gt; "2023-12", "2023-11", "2023-10"
$ name       &lt;chr&gt; "Jon Snow", "Arya Stark", "Tyrion Lannister"
$ some_value &lt;dbl&gt; 1, 2, 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">text =</span> (glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{name} had the value {some_value} in {year_month}"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  year_month name             some_value text                                   
  &lt;chr&gt;      &lt;chr&gt;                 &lt;dbl&gt; &lt;glue&gt;                                 
1 2023-12    Jon Snow                  1 Jon Snow had the value 1 in 2023-12    
2 2023-11    Arya Stark                2 Arya Stark had the value 2 in 2023-11  
3 2023-10    Tyrion Lannister          3 Tyrion Lannister had the value 3 in 20…</code></pre>
</div>
</div>
</section></section>
<section>
<section id="factors-wih-forcats" class="title-slide slide level1 center">
<h1>Factors wih<br><br> {forcats}</h1>

</section>
<section id="what-is-a-factor" class="slide level2">
<h2>What is a factor</h2>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/forcats-logo.png"></p>
</div><div class="column" style="width:70%;">
<ul>
<li>A factor is an <strong>integer vector</strong> with a <strong>levels</strong> attribute that stores a set of mappings between integers and categorical values.</li>
<li>So, stored as numbers but rendered as labels (similar to SPSS)</li>
</ul>
</div>
</div>
</section>
<section id="creating-factors" class="slide level2">
<h2>Creating factors</h2>
<ul>
<li>A character vector</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>some_char_vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "Treatment" "Placebo"   "Placebo"   "Treatment" "Placebo"   "Placebo"  
  [7] "Placebo"   "Placebo"   "Placebo"   "Treatment" "Treatment" "Treatment"
 [13] "Treatment" "Treatment" "Treatment" "Treatment" "Placebo"   "Treatment"
 [19] "Placebo"   "Placebo"   "Treatment" "Placebo"   "Treatment" "Placebo"  
 [25] "Treatment" "Placebo"   "Treatment" "Placebo"   "Treatment" "Placebo"  
 [31] "Placebo"   "Placebo"   "Placebo"   "Treatment" "Placebo"   "Treatment"
 [37] "Treatment" "Placebo"   "Placebo"   "Treatment" "Treatment" "Placebo"  
 [43] "Placebo"   "Placebo"   "Placebo"   "Treatment" "Placebo"   "Placebo"  
 [49] "Treatment" "Placebo"   "Treatment" "Treatment" "Placebo"   "Placebo"  
 [55] "Placebo"   "Treatment" "Treatment" "Treatment" "Placebo"   "Placebo"  
 [61] "Placebo"   "Treatment" "Treatment" "Placebo"   "Treatment" "Treatment"
 [67] "Treatment" "Placebo"   "Treatment" "Placebo"   "Treatment" "Treatment"
 [73] "Placebo"   "Treatment" "Treatment" "Treatment" "Treatment" "Treatment"
 [79] "Placebo"   "Treatment" "Treatment" "Placebo"   "Treatment" "Treatment"
 [85] "Treatment" "Placebo"   "Placebo"   "Placebo"   "Placebo"   "Placebo"  
 [91] "Treatment" "Treatment" "Treatment" "Placebo"   "Treatment" "Placebo"  
 [97] "Treatment" "Placebo"   "Treatment" "Placebo"  </code></pre>
</div>
</div>
</section>
<section id="creating-factors-1" class="slide level2">
<h2>Creating factors</h2>
<ul>
<li>At the bottom now we see <strong>Levels</strong></li>
<li>This means that there are two possible unique values, with those labels: <em>Placebo</em> and <em>Treatment</em></li>
<li>But R is storing them as numbers</li>
</ul>
<div class="scrolling-300">
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co">#A vector with 100 cases of either treatment or placebo</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>some_factor_vec <span class="ot">&lt;-</span> <span class="fu">factor</span>(some_char_vec)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>some_factor_vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] Treatment Placebo   Placebo   Treatment Placebo   Placebo   Placebo  
  [8] Placebo   Placebo   Treatment Treatment Treatment Treatment Treatment
 [15] Treatment Treatment Placebo   Treatment Placebo   Placebo   Treatment
 [22] Placebo   Treatment Placebo   Treatment Placebo   Treatment Placebo  
 [29] Treatment Placebo   Placebo   Placebo   Placebo   Treatment Placebo  
 [36] Treatment Treatment Placebo   Placebo   Treatment Treatment Placebo  
 [43] Placebo   Placebo   Placebo   Treatment Placebo   Placebo   Treatment
 [50] Placebo   Treatment Treatment Placebo   Placebo   Placebo   Treatment
 [57] Treatment Treatment Placebo   Placebo   Placebo   Treatment Treatment
 [64] Placebo   Treatment Treatment Treatment Placebo   Treatment Placebo  
 [71] Treatment Treatment Placebo   Treatment Treatment Treatment Treatment
 [78] Treatment Placebo   Treatment Treatment Placebo   Treatment Treatment
 [85] Treatment Placebo   Placebo   Placebo   Placebo   Placebo   Treatment
 [92] Treatment Treatment Placebo   Treatment Placebo   Treatment Placebo  
 [99] Treatment Placebo  
Levels: Placebo Treatment</code></pre>
</div>
</div>
</div>
</section>
<section id="modifying-factors" class="slide level2">
<h2>Modifying factors</h2>
<ul>
<li>Change the order with <code>fct_relevel()</code>
<ul>
<li>Useful for plotting</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Cjecking the levels</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(some_factor_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Placebo"   "Treatment"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Changing the order of the levels</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>some_factor_vec <span class="sc">%&gt;%</span> <span class="fu">fct_relevel</span>(<span class="st">"Treatment"</span>,<span class="st">"Placebo"</span>) <span class="sc">%&gt;%</span> <span class="fu">levels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Treatment" "Placebo"  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Relabel to lower case</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>some_factor_vec <span class="sc">%&gt;%</span> <span class="fu">fct_recode</span>(<span class="at">new_name_treatment =</span> <span class="st">"Treatment"</span>, <span class="at">new_name_placebo =</span> <span class="st">"Placebo"</span>) <span class="sc">%&gt;%</span> levels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "new_name_placebo"   "new_name_treatment"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Apply a function to all levels. Eg. convert to upper case</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>some_factor_vec <span class="sc">%&gt;%</span> <span class="fu">fct_relabel</span>(str_to_upper) <span class="sc">%&gt;%</span> levels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PLACEBO"   "TREATMENT"</code></pre>
</div>
</div>
</section></section>
<section>
<section id="dates-and-times" class="title-slide slide level1 center">
<h1>Dates and times</h1>

</section>
<section id="creating-and-formating-dates" class="slide level2">
<h2>Creating and formating dates</h2>
<ul>
<li>Create a date with <code>as.Date()</code> function</li>
<li>The default date pattern is year, month, day
<ul>
<li>e.g.&nbsp;2023-11-20, or 2023/11/20</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"2023/11/20"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-11-20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"20-11-2023"</span>) <span class="co">#No error! But not what we wanted</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0020-11-20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"20-11-2023"</span>, <span class="at">format =</span> <span class="st">"%d-%m-%Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-11-20"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.Date</span>(<span class="st">"20/Nov/23"</span>, <span class="at">format =</span> <span class="st">"%d/%b/%y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-11-20"</code></pre>
</div>
</div>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Sometimes when trying to create a data R thinks it has a valid format and creates a date that is not what we want.</p>
</div>
</div>
</div>
</section>
<section id="creating-and-formating-dates-1" class="slide level2">
<h2>Creating and formating dates</h2>

<img data-src="img/common_r_date_formats.png" class="r-stretch"></section></section>
<section>
<section id="useful-patterns-and-functions" class="title-slide slide level1 center">
<h1>Useful patterns <br><br> and functions</h1>

</section>
<section id="set.seed" class="slide level2">
<h2>set.seed</h2>
<ul>
<li>Using <code>set.seed()</code> before a calculation that uses generated (pseudo-) random values will yield the same results</li>
<li>This is true as long as the same random generations are called in the same order after set seed!</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.720903896 0.875773193 0.760982328 0.886124566 0.456480960 0.166371785
 [7] 0.325095387 0.509224336 0.727705254 0.989736938 0.034535435 0.152373490
[13] 0.735684952 0.001136587 0.391203335 0.462494654 0.388143982 0.402485142
[19] 0.178963585 0.951658754</code></pre>
</div>
</div>
</section>
<section id="iconv-translitt" class="slide level2">
<h2>iconv translitt</h2>
<ul>
<li>This pattern is useful to remove accented characters from latin character strings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iconv</span>(<span class="st">"Mação"</span>, <span class="at">to=</span><span class="st">'ASCII//TRANSLIT'</span>, <span class="at">sub=</span><span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Macao"</code></pre>
</div>
</div>
</section>
<section id="excel_numeric_to_date" class="slide level2">
<h2>excel_numeric_to_date()</h2>
<ul>
<li>Excel treats dates as numbers, with 1 being 1<sup>st</sup> of January 1900</li>
<li>Sometimes when importing to R the value will be loaded as a number</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>my_excel_date_number <span class="ot">&lt;-</span><span class="dv">45251</span> <span class="co">#20-11-2023</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>my_excel_date_number <span class="sc">%&gt;%</span> janitor<span class="sc">::</span><span class="fu">excel_numeric_to_date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-11-21"</code></pre>
</div>
</div>
</section></section>
<section id="exercises" class="title-slide slide level1 center">
<h1>Exercises</h1>


<img src="../images/logo.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><a href="https://github.com/c-matos">Carlos Matos</a> // ISPUP::R4HEADS(2023)</p>
</div>
</section>


    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"b9367d2debfff027","url":"https://reveal-multiplex.glitch.me/"},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealPointer, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>