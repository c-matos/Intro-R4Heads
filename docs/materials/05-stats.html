<!DOCTYPE html>
<html lang="en"><head>
<link href="..//images/logo.png" rel="icon" type="image/png">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.510">

  <meta name="author" content="Carlos Matos // ISPUP // November 2023">
  <title>Statistics  with R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #383a42;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #383a42; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #50a14f; } /* Annotation */
    code span.at { color: #a626a4; } /* Attribute */
    code span.bn { color: #986801; } /* BaseN */
    code span.bu { color: #a626a4; } /* BuiltIn */
    code span.cf { color: #a626a4; } /* ControlFlow */
    code span.ch { color: #50a14f; } /* Char */
    code span.cn { color: #986801; } /* Constant */
    code span.co { color: #a0a1a7; font-style: italic; } /* Comment */
    code span.cv { color: #e45649; font-style: italic; } /* CommentVar */
    code span.do { color: #e45649; } /* Documentation */
    code span.dt { color: #a626a4; } /* DataType */
    code span.dv { color: #986801; } /* DecVal */
    code span.er { color: #f44747; text-decoration: underline; } /* Error */
    code span.ex { color: #4078f2; font-weight: bold; } /* Extension */
    code span.fl { color: #986801; } /* Float */
    code span.fu { color: #4078f2; } /* Function */
    code span.im { color: #50a14f; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #a626a4; } /* Keyword */
    code span.op { color: #a626a4; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #a626a4; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #0184bc; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #50a14f; } /* String */
    code span.va { color: #e45649; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Statistics  with R">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Statistics <br> with R</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://github.com/c-matos" style="color:#28a87d;font-weight:600;">Carlos Matos</a> // ISPUP // November 2023 
</div>
</div>
</div>

</section>
<section id="very-brief-overview-of-hypothesis-testing" class="slide level2">
<h2>Very brief overview of hypothesis testing</h2>
<p><br></p>
<ol type="1">
<li><p>Define the null hypothesis (<strong>H<inf>0</inf></strong>)</p></li>
<li><p>Set the significance level (<strong>alpha</strong>) - usually 0.05</p></li>
<li><p>Get the test statistic with your sample data and the p-value</p>
<dl>
<dt>p-value</dt>
<dd>
probability of obtaining the result we obtained or even more extreme, assuming H0 is true.
</dd>
</dl></li>
<li><p>Interpret the p-value</p>
<ol type="i">
<li>if p &lt; alpha, reject H<inf>0</inf></li>
<li>if p &gt;= alpha, not enough evidence to reject H<inf>0</inf></li>
</ol></li>
</ol>
</section>
<section id="statistical-tests" class="slide level2">
<h2>Statistical tests</h2>

<img data-src="img/stats-cheatsheet.png" class="r-stretch"></section>
<section>
<section id="no-real-dependent-or-independent-variables" class="title-slide slide level1 center">
<h1>No real <br><br>dependent or <br><br> independent <br><br> variables</h1>

</section>
<section id="chi-square-test" class="slide level2">
<h2>Chi-square test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(medicaldata)  <span class="co">#Sample datasets</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(covid_testing<span class="sc">$</span>result, covid_testing<span class="sc">$</span>gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  covid_testing$result and covid_testing$gender
X-squared = 1.2028, df = 2, p-value = 0.5481</code></pre>
</div>
</div>
</section>
<section id="chi-square-test-1" class="slide level2">
<h2>Chi-square test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot) <span class="co">#Automatically display common statistical tests in plots</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbarstats</span>(<span class="at">data =</span> covid_testing, <span class="at">x =</span> result, <span class="at">y =</span> gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-stats_files/figure-revealjs/unnamed-chunk-2-1.png" width="2020" class="r-stretch"></section></section>
<section id="continuous-dependent-variables" class="title-slide slide level1 center">
<h1>Continuous <br><br> dependent <br><br> variables</h1>

</section>

<section id="categorical-predictors" class="title-slide slide level1 center" data-background-color="#FFD166">
<h1>Categorical <br><br> predictors</h1>

</section>

<section>
<section id="parametric-tests" class="title-slide slide level1 center" data-background-color="#e6d9f2">
<h1>Parametric tests</h1>

</section>
<section id="statistical-tests-1" class="slide level2">
<h2>Statistical tests</h2>

<img data-src="img/stats-cheatsheet.png" class="r-stretch"></section>
<section id="one-sample-t-test" class="slide level2">
<h2>One sample t-test</h2>
<ul>
<li><strong><em>Numeric</em></strong> outcome variable (in R data type terms)</li>
<li>Comparing <strong>one mean</strong> with a target value</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rio)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#develop datest</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Dataset with a development index at 5yo (general1) and 8yo (general2)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Includes socioeconomic class variable, with value 1 = high, 2 = mewdium and 3 = low</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Import from github and create a factor</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>develop <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"https://github.com/c-matos/Intro-R4Heads/raw/main/materials/data/develop.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">soclass =</span> <span class="fu">factor</span>(soclass, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"high"</span>,<span class="st">"medium"</span>,<span class="st">"low"</span>), <span class="co">#The labels that we see</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="co">#the values that are coded</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ordered =</span> T)) <span class="co"># TRUE if the values have an inherent order e.g. high &gt; medium &gt; low</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="one-sample-t-test-1" class="slide level2">
<h2>One sample t-test</h2>
<ul>
<li><strong><em>Numeric</em></strong> outcome variable (in R data type terms)</li>
<li>Comparing <strong>one mean</strong> with a target value</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> develop<span class="sc">$</span>general1, <span class="at">mu =</span> <span class="dv">120</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  develop$general1
t = -2.3548, df = 38, p-value = 0.0238
alternative hypothesis: true mean is not equal to 120
95 percent confidence interval:
 114.7070 119.6007
sample estimates:
mean of x 
 117.1538 </code></pre>
</div>
</div>
</section>
<section id="paired-sample-t-test" class="slide level2">
<h2>Paired Sample t-test</h2>
<ul>
<li><strong><em>Numeric</em></strong> outcome variable (in R data type terms)</li>
<li>Comparing <strong>two paired means</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Paired samples t-test</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> develop<span class="sc">$</span>general1, <span class="at">y =</span> develop<span class="sc">$</span>general2,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  develop$general1 and develop$general2
t = 4.0779, df = 38, p-value = 0.0002239
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 2.233808 6.637987
sample estimates:
mean difference 
       4.435897 </code></pre>
</div>
</div>
</section>
<section id="independent-samples-t-test" class="slide level2">
<h2>Independent Samples t-test</h2>
<ul>
<li><strong><em>Numeric</em></strong> outcome variable (in R data type terms)</li>
<li>Comparing <strong>two independent means</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using the polyps data from the {medicaldata} package</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(medicaldata)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(number12m <span class="sc">~</span> treatment, <span class="at">data =</span> polyps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  number12m by treatment
t = 3.6114, df = 16.901, p-value = 0.002172
alternative hypothesis: true difference in means between group placebo and group sulindac is not equal to 0
95 percent confidence interval:
 10.69898 40.79597
sample estimates:
 mean in group placebo mean in group sulindac 
             35.636364               9.888889 </code></pre>
</div>
</div>
<ul>
<li>Are variances equal?</li>
</ul>
</section>
<section id="levene-test-for-homogeneity-of-variances" class="slide level2">
<h2>Levene test for homogeneity of variances</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(<span class="at">y =</span> number12m <span class="sc">~</span> treatment, <span class="at">data =</span> polyps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  1  2.5663 0.1266
      18               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(number12m <span class="sc">~</span> treatment, <span class="at">data =</span> polyps, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  number12m by treatment
t = 3.4449, df = 18, p-value = 0.00289
alternative hypothesis: true difference in means between group placebo and group sulindac is not equal to 0
95 percent confidence interval:
 10.04479 41.45016
sample estimates:
 mean in group placebo mean in group sulindac 
             35.636364               9.888889 </code></pre>
</div>
</div>
</section>
<section id="t-test-levene-test" class="slide level2">
<h2>T-test + Levene test</h2>
<p><br></p>
<ul>
<li>Summary</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#One sample t.test</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> a_vector, <span class="at">mu =</span> some_value) </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Paired samples t.test</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> a_vector, <span class="at">y =</span> other_vector, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Independent samples t.test</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(num_vec <span class="sc">~</span> <span class="dv">2</span>_levels_cat_vec, <span class="at">data =</span> some_df, <span class="at">var.equal =</span> T or F) </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Levene Test for homogeneity of variances</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">leveneTest</span>(<span class="at">y =</span> num_vec <span class="sc">~</span> <span class="dv">2</span>_levels_cat_vec, <span class="at">data =</span> some_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="one-way-anova" class="slide level2">
<h2>One-Way ANOVA</h2>
<ul>
<li><strong><em>Numeric</em></strong> outcome variable (in R data type terms)</li>
<li>Comparing <strong>more than two means</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(general1 <span class="sc">~</span> soclass, <span class="at">data =</span> develop)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">oneway.test</span>(general1 <span class="sc">~</span> soclass, <span class="at">data =</span> develop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  2  0.3116 0.7342
      36               

    One-way analysis of means (not assuming equal variances)

data:  general1 and soclass
F = 5.9897, num df = 2.000, denom df = 19.942, p-value = 0.009179</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Remember that a p &lt; alpha for the levene test and for the one-way ANOVA means <strong>at least one</strong> difference between groups. If that is the case, then pairwise comparisons need to be performed to identify which groups differ</p>
</div>
</div>
</div>
</section>
<section id="one-way-anova-1" class="slide level2">
<h2>One-Way ANOVA</h2>
<ul>
<li>Pairwise comparissons</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairwise.t.test</span>(<span class="at">x =</span> develop<span class="sc">$</span>general1,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">g =</span> develop<span class="sc">$</span>soclass,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  develop$general1 and develop$soclass 

       high   medium
medium 0.0250 -     
low    0.0018 0.8172

P value adjustment method: bonferroni </code></pre>
</div>
</div>
<ul>
<li><em>High - low</em> and <em>high - medium</em> are significantly different</li>
</ul>
</section>
<section id="one-way-anova-2" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">One-Way ANOVA</h2>
<ul>
<li>Visualizing with ggstatsplot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb20-1" class="hljs-ln-code"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb20-2" class="hljs-ln-code"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3" class="hljs-ln-code"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>develop <span class="sc">%&gt;%</span> </span>
<span id="cb20-4" class="hljs-ln-code"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggbetweenstats</span>(<span class="at">x =</span> soclass, </span>
<span id="cb20-5" class="hljs-ln-code"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> general1, </span>
<span id="cb20-6" class="hljs-ln-code"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb20-7" class="hljs-ln-code"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">pairwise.display =</span> <span class="st">"all"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="one-way-anova-2-output" class="slide level2 output-location-slide"><h2>One-Way ANOVA</h2><div class="cell output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-10-1.png" width="2020"></p>
</figure>
</div>
</div>
</div></section><section id="one-way-anova-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">One-Way ANOVA</h2>
<ul>
<li>Extracting the statistics</li>
</ul>
<div class="cell custom-30-70 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb21" data-code-line-numbers="8"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb21-1" class="hljs-ln-code"><a href="#cb21-1"></a><span class="fu">library</span>(ggstatsplot)</span>
<span id="cb21-2" class="hljs-ln-code"><a href="#cb21-2"></a></span>
<span id="cb21-3" class="hljs-ln-code"><a href="#cb21-3"></a>develop <span class="sc">%&gt;%</span> </span>
<span id="cb21-4" class="hljs-ln-code"><a href="#cb21-4"></a>  <span class="fu">ggbetweenstats</span>(<span class="at">x =</span> soclass, </span>
<span id="cb21-5" class="hljs-ln-code"><a href="#cb21-5"></a>                 <span class="at">y =</span> general1, </span>
<span id="cb21-6" class="hljs-ln-code"><a href="#cb21-6"></a>                 <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span>,</span>
<span id="cb21-7" class="hljs-ln-code"><a href="#cb21-7"></a>                 <span class="at">pairwise.display =</span> <span class="st">"all"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8" class="hljs-ln-code"><a href="#cb21-8"></a>  <span class="fu">extract_stats</span>() <span class="sc">%&gt;%</span> glimpse</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code>List of 7
 $ subtitle_data            : sttsExpr [1 × 14] (S3: statsExpressions/tbl_df/tbl/data.frame)
  ..$ statistic        : num 5.99
  ..$ df               : num 2
  ..$ df.error         : num 19.9
  ..$ p.value          : num 0.00918
  ..$ method           : chr "One-way analysis of means (not assuming equal variances)"
  ..$ effectsize       : chr "Omega2"
  .. ..- attr(*, "na.action")= 'omit' int [1:3] 2 3 4
  ..$ estimate         : num 0.303
  ..$ conf.level       : num 0.95
  ..$ conf.low         : num 0.0249
  ..$ conf.high        : num 1
  ..$ conf.method      : chr "ncp"
  ..$ conf.distribution: chr "F"
  ..$ n.obs            : int 39
  ..$ expression       :List of 1
 $ caption_data             : sttsExpr [6 × 17] (S3: statsExpressions/tbl_df/tbl/data.frame)
  ..$ term              : chr [1:6] "mu" "soclass-high" "soclass-medium" "soclass-low" ...
  ..$ pd                : num [1:6] 1 0.998 0.823 0.995 1 ...
  ..$ prior.distribution: chr [1:6] "cauchy" "cauchy" "cauchy" "cauchy" ...
  ..$ prior.location    : num [1:6] 0 0 0 0 0 0
  ..$ prior.scale       : num [1:6] 0.707 0.707 0.707 0.707 0.707 0.707
  ..$ bf10              : num [1:6] 15.4 15.4 15.4 15.4 15.4 ...
  ..$ method            : chr [1:6] "Bayes factors for linear models" "Bayes factors for linear models" "Bayes factors for linear models" "Bayes factors for linear models" ...
  ..$ log_e_bf10        : num [1:6] 2.73 2.73 2.73 2.73 2.73 ...
  ..$ effectsize        : chr [1:6] "Bayesian R-squared" "Bayesian R-squared" "Bayesian R-squared" "Bayesian R-squared" ...
  ..$ estimate          : num [1:6] 0.222 0.222 0.222 0.222 0.222 ...
  ..$ std.dev           : num [1:6] 0.12 0.12 0.12 0.12 0.12 ...
  ..$ conf.level        : num [1:6] 0.95 0.95 0.95 0.95 0.95 0.95
  ..$ conf.low          : num [1:6] 0 0 0 0 0 0
  ..$ conf.high         : num [1:6] 0.39 0.39 0.39 0.39 0.39 ...
  ..$ conf.method       : chr [1:6] "HDI" "HDI" "HDI" "HDI" ...
  ..$ n.obs             : int [1:6] 39 39 39 39 39 39
  ..$ expression        :List of 6
 $ pairwise_comparisons_data: sttsExpr [3 × 9] (S3: statsExpressions/tbl_df/tbl/data.frame)
  ..$ group1         : chr [1:3] "high" "high" "medium"
  ..$ group2         : chr [1:3] "low" "medium" "low"
  ..$ statistic      : num [1:3] -4.92 -3.87 -1.62
  ..$ p.value        : num [1:3] 0.0237 0.1187 1
  ..$ alternative    : chr [1:3] "two.sided" "two.sided" "two.sided"
  ..$ distribution   : chr [1:3] "q" "q" "q"
  ..$ p.adjust.method: chr [1:3] "Bonferroni" "Bonferroni" "Bonferroni"
  ..$ test           : chr [1:3] "Games-Howell" "Games-Howell" "Games-Howell"
  ..$ expression     :List of 3
 $ descriptive_data         : NULL
 $ one_sample_data          : NULL
 $ tidy_data                : NULL
 $ glance_data              : NULL</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="non-parametric-tests" class="title-slide slide level1 center" data-background-color="#e6d9f2">
<h1>Non-parametric <br><br>tests</h1>

</section>
<section id="wilcoxon-signed-rank-test" class="slide level2">
<h2>Wilcoxon signed-rank test</h2>
<ul>
<li>Used in similar situations to the one sample t-test, but tests the <strong>median</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>develop <span class="ot">&lt;-</span> develop <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">general_dif =</span> general2 <span class="sc">-</span> general1)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(develop<span class="sc">$</span>general_dif, <span class="at">exact =</span> F,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">correct =</span> F) <span class="co">#Do not use continuity correction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank test

data:  develop$general_dif
V = 142, p-value = 0.0005297
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="mann-whitney-u-test" class="slide level2">
<h2>Mann-Whitney U test</h2>
<ul>
<li>Used to compare <strong>two</strong> sample <strong>means</strong> (similar to Independent samples t-test)</li>
<li>It’s the same function as the wilcoxon test</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(number12m <span class="sc">~</span> treatment, <span class="at">data =</span> polyps,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">exact =</span> F, <span class="at">correct =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test

data:  number12m by treatment
W = 88, p-value = 0.003408
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="kruskal-wallis-test" class="slide level2">
<h2>Kruskal-Wallis test</h2>
<ul>
<li><strong><em>Numerical</em></strong> outcome variable, comparing <strong>more than two means</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(general1 <span class="sc">~</span> soclass, <span class="at">data =</span> develop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  general1 by soclass
Kruskal-Wallis chi-squared = 9.8587, df = 2, p-value = 0.007231</code></pre>
</div>
</div>
</section></section>
<section>
<section id="regression-modelling" class="title-slide slide level1 center" data-background-color="#c4edff">
<h1>Regression <br><br> modelling</h1>
<p><br> <span class="math display">\[
g(Y) = f(X,\beta)
\]</span></p>
</section>
<section id="statistical-models" class="slide level2">
<h2>Statistical models</h2>
<ul>
<li>Used to describe the relation of one outcome with multiple predictors</li>
<li>The choice of model will depend on several factors
<ul>
<li>Research question</li>
<li>Design type</li>
<li>Type of outcome</li>
<li>Distributional assumptions</li>
</ul></li>
</ul>
</section>
<section id="statistical-models-1" class="slide level2">
<h2>Statistical models</h2>
<p><br></p>
<p>Why do we care about modelling?</p>
<ol type="1">
<li><strong>Describe</strong> strength of the association between outcome and factors of interest</li>
<li><strong>Adjust</strong> for confounders, therefore reducing noise</li>
<li><strong>Identify</strong> health determinants and have insights about causality</li>
<li><strong>Predict</strong> outcomes for diagnostic and prognostic purposes</li>
</ol>
<p><br></p>
<p>Examples include linear regression, logistic regression, Poisson regresison, Cox regression</p>
</section>
<section id="section" class="slide level2">
<h2></h2>

<img data-src="img/stats-cheatsheet.png" class="r-stretch"></section></section>
<section>
<section id="continuousmixed-predictors" class="title-slide slide level1 center" data-background-color="#FFD166">
<h1>Continuous/Mixed <br><br> predictors</h1>

</section>
<section id="linear-regression" class="slide level2">
<h2>Linear regression</h2>
<p><br></p>
<ul>
<li>General syntax of a statistical model in R
<ul>
<li>A <code>formula</code> argument, to specify the column names of the variables used in the model</li>
<li>A <code>data</code> argument, to specify the dataset</li>
</ul></li>
<li>The tilde <code>~</code> is used to create formulas
<ul>
<li>The outcome goes to the <strong>left</strong></li>
<li>The predictors go to the <strong>right</strong></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> outcome <span class="sc">~</span> predictor1 <span class="sc">+</span> ... <span class="sc">+</span> predictor_X,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> my_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="linear-regression-1" class="slide level2">
<h2>Linear regression</h2>
<p><br></p>
<ul>
<li>Exploring the <code>blood_pressure</code> dataset</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>bp_dataset <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"data/blood_pressure.sav"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 300
Columns: 5
$ id        &lt;dbl&gt; 5147, 2786, 3489, 5454, 3162, 2734, 5154, 5395, 5679, 3152, …
$ age       &lt;dbl&gt; 35, 19, 26, 31, 26, 31, 68, 73, 59, 80, 49, 48, 54, 48, 48, …
$ weight    &lt;dbl&gt; 81, 65, 78, 75, 92, 75, 76, 90, 72, 71, 64, 83, 75, 91, 78, …
$ systolic  &lt;dbl&gt; 139, 116, 141, 135, 148, 136, 121, 129, 126, 167, 133, 117, …
$ diastolic &lt;dbl&gt; 78, 73, 94, 86, 86, 86, 76, 81, 78, 87, 84, 64, 97, 89, 82, …</code></pre>
</div>
</div>
</section>
<section id="linear-regression-2" class="slide level2">
<h2>Linear regression</h2>
<ul>
<li>Modelling systolic blood pressure as a function of age</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Storing the model results in the "my_lm" object</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>my_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> systolic <span class="sc">~</span> age,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> bp_dataset)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>my_lm <span class="co"># Only shows the coefficients</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = systolic ~ age, data = bp_dataset)

Coefficients:
(Intercept)          age  
   105.3207       0.6868  </code></pre>
</div>
</div>
<blockquote>
<p>Explore the my_lm object with View(my_lm). What do you see?</p>
</blockquote>
</section>
<section id="linear-regression-3" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Linear regression</h2>
<ul>
<li><code>Summary()</code> shows more details about the model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb34-1" class="hljs-ln-code"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exploring the "fit" object</span></span>
<span id="cb34-2" class="hljs-ln-code"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_lm) <span class="co">#Shows more info</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = systolic ~ age, data = bp_dataset)

Residuals:
   Min     1Q Median     3Q    Max 
-49.95 -11.28  -2.40  10.71  74.16 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 105.32075    3.02978   34.76   &lt;2e-16 ***
age           0.68677    0.06242   11.00   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 18.59 on 298 degrees of freedom
Multiple R-squared:  0.2889,    Adjusted R-squared:  0.2865 
F-statistic:   121 on 1 and 298 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="tidy-model-outputs-with-broom" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Tidy model outputs with {broom}</h2>
<ul>
<li><a href="https://broom.tidymodels.org/"><code>tidy()</code></a> summarizes information about model components</li>
</ul>
<div class=".columns">
<div class="column" style="width:20%;">
<p><img data-src="img/broom-hex.png"></p>
</div>
<div class="column" style="width:79%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb36-1" class="hljs-ln-code"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term        estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)  105.       3.03        34.8 7.21e-107   99.4     111.   
2 age            0.687    0.0624      11.0 7.45e- 24    0.564     0.810</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tidy-model-outputs-with-broom-1" class="slide level2">
<h2>Tidy model outputs with {broom}</h2>
<ul>
<li><a href="https://broom.tidymodels.org/"><code>glance()</code></a> reports information about the entire model</li>
</ul>
<div class=".columns">
<div class="column" style="width:20%;">
<p><img data-src="img/broom-hex.png"></p>
</div>
<div class="column" style="width:79%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">glance</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0.289         0.286  18.6      121. 7.45e-24     1 -1301. 2609. 2620.
# ℹ 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="tidy-model-outputs-with-broom-2" class="slide level2">
<h2>Tidy model outputs with {broom}</h2>
<ul>
<li><a href="https://broom.tidymodels.org/"><code>augment()</code></a> adds informations about observations to a dataset</li>
<li>The meaning of each column can be found <a href="https://broom.tidymodels.org/reference/augment.lm.html">here</a></li>
</ul>
<div class=".columns">
<div class="column" style="width:20%;">
<p><img data-src="img/broom-hex.png"></p>
</div>
<div class="column" style="width:79%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">augment</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 × 8
   systolic   age .fitted .resid    .hat .sigma   .cooksd .std.resid
      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
 1      139    35    129.   9.64 0.00455   18.6 0.000618       0.520
 2      116    19    118.  -2.37 0.0112    18.6 0.0000930     -0.128
 3      141    26    123.  17.8  0.00757   18.6 0.00354        0.963
 4      135    31    127.   8.39 0.00567   18.6 0.000584       0.453
 5      148    26    123.  24.8  0.00757   18.6 0.00686        1.34 
 6      136    31    127.   9.39 0.00567   18.6 0.000732       0.507
 7      121    68    152. -31.0  0.00910   18.5 0.0129        -1.68 
 8      129    73    155. -26.5  0.0119    18.6 0.0124        -1.43 
 9      126    59    146. -19.8  0.00542   18.6 0.00312       -1.07 
10      167    80    160.   6.74 0.0168    18.6 0.00114        0.366
# ℹ 290 more rows</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="linear-regression-4" class="slide level2">
<h2>Linear regression</h2>
<ul>
<li>Plotting the linear correlation between two variables</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(bp_dataset, <span class="at">y =</span> systolic, <span class="at">x =</span> age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-stats_files/figure-revealjs/unnamed-chunk-21-1.png" width="2020" class="r-stretch"></section>
<section id="what-does-all-that-mean" class="slide level2">
<h2>What does all that mean?</h2>

<img data-src="img/welch_t-test.png" class="r-stretch"></section>
<section id="alternative-plot-with-ggpmisc" class="slide level2">
<h2>Alternative plot with {ggpmisc}</h2>
<div class="cell custom-40-60 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>bp_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(diastolic, weight)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>, <span class="st">"adj.R2"</span>, <span class="st">"P"</span>, <span class="st">"n"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-22-1.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Easy way to have finer control over what values are shown in the plot</p>
</section>
<section id="linear-regression-5" class="slide level2">
<h2>Linear regression</h2>
<ul>
<li>Plotting the coefficients</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plotting the coefficients</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoefstats</span>(my_lm, <span class="at">exclude.intercept =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="05-stats_files/figure-revealjs/unnamed-chunk-23-1.png" width="2020" class="r-stretch"></section>
<section id="linear-regression-6" class="slide level2">
<h2>Linear regression</h2>
<ul>
<li>What if we want to use the model to make predictions for a 55yo person?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create a data.frame with the new data</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">age =</span> <span class="dv">55</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Make the prediction</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(my_lm, new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
143.0932 </code></pre>
</div>
</div>
</section>
<section id="linear-regression-7" class="slide level2">
<h2>Linear regression</h2>
<ul>
<li>Example with categorical covariates</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Let's change the dataset to add a mock categorical variable with 3 levels</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Randomly add the values "High", "Medium" or "Low" to a new variable</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>bp_dataset_mock <span class="ot">&lt;-</span> bp_dataset <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mock =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"High"</span>,<span class="st">"Medium"</span>,<span class="st">"Low"</span>), <span class="dv">300</span>, <span class="at">replace =</span>T))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>my_lm_mock <span class="ot">&lt;-</span> <span class="fu">lm</span>(diastolic <span class="sc">~</span> age <span class="sc">+</span> weight <span class="sc">+</span> mock, <span class="at">data =</span> bp_dataset_mock)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>my_lm_mock <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   58.8      3.62      16.2   8.97e-43
2 age            0.154    0.0383     4.01  7.68e- 5
3 weight         0.260    0.0448     5.80  1.72e- 8
4 mockLow       -0.423    1.56      -0.270 7.87e- 1
5 mockMedium    -5.29     1.68      -3.16  1.76e- 3</code></pre>
</div>
</div>
<ul>
<li>Dummy variables are created automatically as needed</li>
</ul>
</section>
<section id="linear-regression-8" class="slide level2">
<h2>Linear regression</h2>
<ul>
<li>Example with interactions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>my_lm_mock <span class="ot">&lt;-</span> <span class="fu">lm</span>(diastolic <span class="sc">~</span>  weight<span class="sc">*</span>age, <span class="at">data =</span> bp_dataset_mock)</span>
<span id="cb49-2"><a href="#cb49-2"></a>my_lm_mock <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 5
  term         estimate std.error statistic       p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
1 (Intercept) 58.7        9.67        6.07  0.00000000394
2 weight       0.230      0.141       1.63  0.103        
3 age          0.137      0.206       0.666 0.506        
4 weight:age   0.000381   0.00297     0.128 0.898        </code></pre>
</div>
</div>
<blockquote>
<p>Instead of the <code>*</code>, use the colon <code>:</code> for the interaction. What is the difference?</p>
</blockquote>
</section>
<section id="linear-regression-9" class="slide level2">
<h2>Linear regression</h2>
<blockquote>
<p>Instead of the <code>*</code>, use the colon <code>:</code> for the interaction. What is the difference?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>my_lm_mock <span class="ot">&lt;-</span> <span class="fu">lm</span>(diastolic <span class="sc">~</span>  weight<span class="sc">:</span>age, <span class="at">data =</span> bp_dataset_mock)</span>
<span id="cb51-2"><a href="#cb51-2"></a>my_lm_mock <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) 72.3      1.68         43.0  2.04e-129
2 weight:age   0.00313  0.000479      6.53 2.82e- 10</code></pre>
</div>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>With the <code>*</code>, the interaction parameters are automatically added <strong>individually</strong> to the model, as well as their interaction, while using <code>:</code> <strong>only</strong> the interaction is added to the model, thus allowing greater control of the final model.</p>
</div>
</div>
</div>
</section>
<section id="linear-regression-10" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Linear regression</h2>
<ul>
<li>The dot <code>.</code> adds all the variables as predictors</li>
<li>It does not include interactions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb53-1" class="hljs-ln-code"><a href="#cb53-1"></a>my_lm_all <span class="ot">&lt;-</span> <span class="fu">lm</span>(diastolic <span class="sc">~</span> ., <span class="at">data =</span> bp_dataset_mock) <span class="co"># the dot add all the variables as predictors</span></span>
<span id="cb53-2" class="hljs-ln-code"><a href="#cb53-2"></a>my_lm_all <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 5
  term         estimate std.error statistic  p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept) 24.8       3.73         6.64  1.50e-10
2 id          -0.000156  0.000308    -0.507 6.13e- 1
3 age         -0.103     0.0354      -2.92  3.77e- 3
4 weight       0.130     0.0363       3.60  3.79e- 4
5 systolic     0.403     0.0289      14.0   3.21e-34
6 mockLow     -1.42      1.22        -1.16  2.45e- 1
7 mockMedium  -3.22      1.31        -2.45  1.47e- 2</code></pre>
</div>
</div>
</section>
<section id="linear-regression-11" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Linear regression</h2>
<ul>
<li>The dot <code>.</code> adds all the variables as predictors</li>
<li>This works well if we want to implement a stepwise approach to variable selection with the <code>{MASS}</code> package</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode r hljs"><span id="cb55-1" class="hljs-ln-code"><a href="#cb55-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb55-2" class="hljs-ln-code"><a href="#cb55-2"></a></span>
<span id="cb55-3" class="hljs-ln-code"><a href="#cb55-3"></a>step <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(my_lm_all, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> F)</span>
<span id="cb55-4" class="hljs-ln-code"><a href="#cb55-4"></a>step <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   24.7      3.72        6.63 1.58e-10
2 age           -0.106    0.0351     -3.02 2.73e- 3
3 weight         0.129    0.0360      3.57 4.20e- 4
4 systolic       0.403    0.0288     14.0  2.81e-34
5 mockLow       -1.41     1.22       -1.16 2.47e- 1
6 mockMedium    -3.22     1.31       -2.46 1.45e- 2</code></pre>
</div>
</div>
</section>
<section id="checking-model-assumptions" class="slide level2">
<h2>Checking model assumptions</h2>
<div class="scrolling">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(step)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-30-1.png" width="2020"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-30-2.png" width="2020"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-30-3.png" width="2020"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-30-4.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="categorical-dependent-variables" class="title-slide slide level1 center">
<h1>Categorical <br><br> dependent variables</h1>

</section>
<section id="statistical-tests-2" class="slide level2">
<h2>Statistical tests</h2>

<img data-src="img/stats-cheatsheet.png" class="r-stretch"></section>
<section id="logistic-regression" class="slide level2">
<h2>Logistic regression</h2>
<ul>
<li>The function <code>glm</code> is used for generalized linear models</li>
<li>The <code>family</code> argument specifies the details of the glm model</li>
</ul>
<div class="cell max-height-300">
<div class="sourceCode cell-code" id="cb58" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>cancer_data <span class="ot">&lt;-</span> rio<span class="sc">::</span><span class="fu">import</span>(<span class="st">"data/cancer_data.xlsx"</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a>logit_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> ., <span class="at">data =</span> cancer_data, </span>
<span id="cb58-3"><a href="#cb58-3"></a>                   <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb58-4"><a href="#cb58-4"></a></span>
<span id="cb58-5"><a href="#cb58-5"></a>logit_model <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = status ~ ., family = "binomial", data = cancer_data)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept) -0.7209579  1.5166269  -0.475  0.63452   
age          0.0219774  0.0210127   1.046  0.29560   
sex2        -1.0021949  0.3737194  -2.682  0.00733 **
ecog         0.7576818  0.2682974   2.824  0.00474 **
meal_cal     0.0001768  0.0004920   0.359  0.71928   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 206.72  on 179  degrees of freedom
Residual deviance: 186.09  on 175  degrees of freedom
AIC: 196.09

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="logistic-regression-1" class="slide level2">
<h2>Logistic regression</h2>
<ul>
<li>Available function families in <code>glm()</code></li>
</ul>
<div class=".columns">
<div class="column" style="width:49%;">
<p><img data-src="img/glm-family.png"></p>
</div>
<div class="column" style="width:50%;">
<p><img data-src="img/glm-families.png"></p>
</div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>If you don’t specify a family, it may use gaussian by default and your output will not be a logistic regression!</p>
</div>
</div>
</div>
</section>
<section id="logistic-regression-2" class="slide level2">
<h2>Logistic regression</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>Remember that the coefficients of a logistic model are the <strong>log</strong> of Odds Ratio</p>
</div>
</div>
</div>
<ul>
<li>We can specify to the <code>tidy()</code> function that we want to <strong>exponentiate</strong> the coefficients</li>
</ul>
<div class="cell max-height-300 custom-30-70 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate is log-OR</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>logit_model <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co">#estimate is OR</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>logit_model <span class="sc">%&gt;%</span> </span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">exponentiate =</span> T, </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">conf.int =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term         estimate std.error statistic p.value
  &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept) -0.721     1.52        -0.475 0.635  
2 age          0.0220    0.0210       1.05  0.296  
3 sex2        -1.00      0.374       -2.68  0.00733
4 ecog         0.758     0.268        2.82  0.00474
5 meal_cal     0.000177  0.000492     0.359 0.719  
# A tibble: 5 × 7
  term        estimate std.error statistic p.value conf.low conf.high
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    0.486  1.52        -0.475 0.635     0.0241     9.55 
2 age            1.02   0.0210       1.05  0.296     0.981      1.07 
3 sex2           0.367  0.374       -2.68  0.00733   0.174      0.760
4 ecog           2.13   0.268        2.82  0.00474   1.28       3.67 
5 meal_cal       1.00   0.000492     0.359 0.719     0.999      1.00 </code></pre>
</div>
</div>
</div>
</section>
<section id="logistic-regression-3" class="slide level2">
<h2>Logistic regression</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>R will <strong>NOT tell you IF</strong> you should exponentiate or not. You could also (wrongly) exponentiate the coefficients of a linear model. You have to know in which situation it makes sense to exponentiate.</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="survival-analysis" class="title-slide slide level1 center" data-background-color="#FFD166">
<h1>Survival analysis</h1>

</section>
<section id="survival-analysis-with-survival" class="slide level2">
<h2>Survival analysis with {survival}</h2>
<div class="cell max-height-300">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsurvfit)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>lung_data <span class="ot">&lt;-</span> lung <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">factor</span>(sex, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Male"</span>,<span class="st">"Female"</span>)))</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>lung_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    inst time status age    sex ph.ecog ph.karno pat.karno meal.cal wt.loss
1      3  306      2  74   Male       1       90       100     1175      NA
2      3  455      2  68   Male       0       90        90     1225      15
3      3 1010      1  56   Male       0       90        90       NA      15
4      5  210      2  57   Male       1       90        60     1150      11
5      1  883      2  60   Male       0      100        90       NA       0
6     12 1022      1  74   Male       1       50        80      513       0
7      7  310      2  68 Female       2       70        60      384      10
8     11  361      2  71 Female       2       60        80      538       1
9      1  218      2  53   Male       1       70        80      825      16
10     7  166      2  61   Male       2       70        70      271      34
11     6  170      2  57   Male       1       80        80     1025      27
12    16  654      2  68 Female       2       70        70       NA      23
13    11  728      2  68 Female       1       90        90       NA       5
14    21   71      2  60   Male      NA       60        70     1225      32
15    12  567      2  57   Male       1       80        70     2600      60
16     1  144      2  67   Male       1       80        90       NA      15
17    22  613      2  70   Male       1       90       100     1150      -5
18    16  707      2  63   Male       2       50        70     1025      22
19     1   61      2  56 Female       2       60        60      238      10
20    21   88      2  57   Male       1       90        80     1175      NA
21    11  301      2  67   Male       1       80        80     1025      17
22     6   81      2  49 Female       0      100        70     1175      -8
23    11  624      2  50   Male       1       70        80       NA      16
24    15  371      2  58   Male       0       90       100      975      13
25    12  394      2  72   Male       0       90        80       NA       0
26    12  520      2  70 Female       1       90        80      825       6
27     4  574      2  60   Male       0      100       100     1025     -13
28    13  118      2  70   Male       3       60        70     1075      20
29    13  390      2  53   Male       1       80        70      875      -7
30     1   12      2  74   Male       2       70        50      305      20
31    12  473      2  69 Female       1       90        90     1025      -1
32     1   26      2  73   Male       2       60        70      388      20
33     7  533      2  48   Male       2       60        80       NA     -11
34    16  107      2  60 Female       2       50        60      925     -15
35    12   53      2  61   Male       2       70       100     1075      10
36     1  122      2  62 Female       2       50        50     1025      NA
37    22  814      2  65   Male       2       70        60      513      28
38    15  965      1  66 Female       1       70        90      875       4
39     1   93      2  74   Male       2       50        40     1225      24
40     1  731      2  64 Female       1       80       100     1175      15
41     5  460      2  70   Male       1       80        60      975      10
42    11  153      2  73 Female       2       60        70     1075      11
43    10  433      2  59 Female       0       90        90      363      27
44    12  145      2  60 Female       2       70        60       NA      NA
45     7  583      2  68   Male       1       60        70     1025       7
46     7   95      2  76 Female       2       60        60      625     -24
47     1  303      2  74   Male       0       90        70      463      30
48     3  519      2  63   Male       1       80        70     1025      10
49    13  643      2  74   Male       0       90        90     1425       2
50    22  765      2  50 Female       1       90       100     1175       4
51     3  735      2  72 Female       1       90        90       NA       9
52    12  189      2  63   Male       0       80        70       NA       0
53    21   53      2  68   Male       0       90       100     1025       0
54     1  246      2  58   Male       0      100        90     1175       7
55     6  689      2  59   Male       1       90        80     1300      15
56     1   65      2  62   Male       0       90        80      725      NA
57     5    5      2  65 Female       0      100        80      338       5
58    22  132      2  57   Male       2       70        60       NA      18
59     3  687      2  58 Female       1       80        80     1225      10
60     1  345      2  64 Female       1       90        80     1075      -3
61    22  444      2  75 Female       2       70        70      438       8
62    12  223      2  48   Male       1       90        80     1300      68
63    21  175      2  73   Male       1       80       100     1025      NA
64    11   60      2  65 Female       1       90        80     1025       0
65     3  163      2  69   Male       1       80        60     1125       0
66     3   65      2  68   Male       2       70        50      825       8
67    16  208      2  67 Female       2       70        NA      538       2
68     5  821      1  64 Female       0       90        70     1025       3
69    22  428      2  68   Male       0      100        80     1039       0
70     6  230      2  67   Male       1       80       100      488      23
71    13  840      1  63   Male       0       90        90     1175      -1
72     3  305      2  48 Female       1       80        90      538      29
73     5   11      2  74   Male       2       70       100     1175       0
74     2  132      2  40   Male       1       80        80       NA       3
75    21  226      2  53 Female       1       90        80      825       3
76    12  426      2  71 Female       1       90        90     1075      19
77     1  705      2  51 Female       0      100        80     1300       0
78     6  363      2  56 Female       1       80        70     1225      -2
79     3   11      2  81   Male       0       90        NA      731      15
80     1  176      2  73   Male       0       90        70      169      30
81     4  791      2  59   Male       0      100        80      768       5
82    13   95      2  55   Male       1       70        90     1500      15
83    11  196      1  42   Male       1       80        80     1425       8
84    21  167      2  44 Female       1       80        90      588      -1
85    16  806      1  44   Male       1       80        80     1025       1
86     6  284      2  71   Male       1       80        90     1100      14
87    22  641      2  62 Female       1       80        80     1150       1
88    21  147      2  61   Male       0      100        90     1175       4
89    13  740      1  44 Female       1       90        80      588      39
90     1  163      2  72   Male       2       70        70      910       2
91    11  655      2  63   Male       0      100        90      975      -1
92    22  239      2  70   Male       1       80       100       NA      23
93     5   88      2  66   Male       1       90        80      875       8
94    10  245      2  57 Female       1       80        60      280      14
95     1  588      1  69 Female       0      100        90       NA      13
96    12   30      2  72   Male       2       80        60      288       7
97     3  179      2  69   Male       1       80        80       NA      25
98    12  310      2  71   Male       1       90       100       NA       0
99    11  477      2  64   Male       1       90       100      910       0
100    3  166      2  70 Female       0       90        70       NA      10
101    1  559      1  58 Female       0      100       100      710      15
102    6  450      2  69 Female       1       80        90     1175       3
103   13  364      2  56   Male       1       70        80       NA       4
104    6  107      2  63   Male       1       90        70       NA       0
105   13  177      2  59   Male       2       50        NA       NA      32
106   12  156      2  66   Male       1       80        90      875      14
107   26  529      1  54 Female       1       80       100      975      -3
108    1   11      2  67   Male       1       90        90      925      NA
109   21  429      2  55   Male       1      100        80      975       5
110    3  351      2  75 Female       2       60        50      925      11
111   13   15      2  69   Male       0       90        70      575      10
112    1  181      2  44   Male       1       80        90     1175       5
113   10  283      2  80   Male       1       80       100     1030       6
114    3  201      2  75 Female       0       90       100       NA       1
115    6  524      2  54 Female       1       80       100       NA      15
116    1   13      2  76   Male       2       70        70      413      20
117    3  212      2  49   Male       2       70        60      675      20
118    1  524      2  68   Male       2       60        70     1300      30
119   16  288      2  66   Male       2       70        60      613      24
120   15  363      2  80   Male       1       80        90      346      11
121   22  442      2  75   Male       0       90        90       NA       0
122   26  199      2  60 Female       2       70        80      675      10
123    3  550      2  69 Female       1       70        80      910       0
124   11   54      2  72   Male       2       60        60      768      -3
125    1  558      2  70   Male       0       90        90     1025      17
126   22  207      2  66   Male       1       80        80      925      20
127    7   92      2  50   Male       1       80        60     1075      13
128   12   60      2  64   Male       1       80        90      993       0
129   16  551      1  77 Female       2       80        60      750      28
130   12  543      1  48 Female       0       90        60       NA       4
131    4  293      2  59 Female       1       80        80      925      52
132   16  202      2  53   Male       1       80        80       NA      20
133    6  353      2  47   Male       0      100        90     1225       5
134   13  511      1  55 Female       1       80        70       NA      49
135    1  267      2  67   Male       0       90        70      313       6
136   22  511      1  74 Female       2       60        40       96      37
137   12  371      2  58 Female       1       80        70       NA       0
138   13  387      2  56   Male       2       80        60     1075      NA
139    1  457      2  54   Male       1       90        90      975      -5
140    5  337      2  56   Male       0      100       100     1500      15
141   21  201      2  73 Female       2       70        60     1225     -16
142    3  404      1  74   Male       1       80        70      413      38
143   26  222      2  76   Male       2       70        70     1500       8
144    1   62      2  65 Female       1       80        90     1075       0
145   11  458      1  57   Male       1       80       100      513      30
146   26  356      1  53 Female       1       90        90       NA       2
147   16  353      2  71   Male       0      100        80      775       2
148   16  163      2  54   Male       1       90        80     1225      13
149   12   31      2  82   Male       0      100        90      413      27
150   13  340      2  59 Female       0      100        90       NA       0
151   13  229      2  70   Male       1       70        60     1175      -2
152   22  444      1  60   Male       0       90       100       NA       7
153    5  315      1  62 Female       0       90        90       NA       0
154   16  182      2  53 Female       1       80        60       NA       4
155   32  156      2  55   Male       2       70        30     1025      10
156   NA  329      2  69   Male       2       70        80      713      20
157   26  364      1  68 Female       1       90        90       NA       7
158    4  291      2  62   Male       2       70        60      475      27
159   12  179      2  63   Male       1       80        70      538      -2
160    1  376      1  56 Female       1       80        90      825      17
161   32  384      1  62 Female       0       90        90      588       8
162   10  268      2  44 Female       1       90       100     2450       2
163   11  292      1  69   Male       2       60        70     2450      36
164    6  142      2  63   Male       1       90        80      875       2
165    7  413      1  64   Male       1       80        70      413      16
166   16  266      1  57 Female       0       90        90     1075       3
167   11  194      2  60 Female       1       80        60       NA      33
168   21  320      2  46   Male       0      100       100      860       4
169    6  181      2  61   Male       1       90        90      730       0
170   12  285      2  65   Male       0      100        90     1025       0
171   13  301      1  61   Male       1       90       100      825       2
172    2  348      2  58 Female       0       90        80     1225      10
173    2  197      2  56   Male       1       90        60      768      37
174   16  382      1  43 Female       0      100        90      338       6
175    1  303      1  53   Male       1       90        80     1225      12
176   13  296      1  59 Female       1       80       100     1025       0
177    1  180      2  56   Male       2       60        80     1225      -2
178   13  186      2  55 Female       1       80        70       NA      NA
179    1  145      2  53 Female       1       80        90      588      13
180    7  269      1  74 Female       0      100       100      588       0
181   13  300      1  60   Male       0      100       100      975       5
182    1  284      1  39   Male       0      100        90     1225      -5
183   16  350      2  66 Female       0       90       100     1025      NA
184   32  272      1  65 Female       1       80        90       NA      -1
185   12  292      1  51 Female       0       90        80     1225       0
186   12  332      1  45 Female       0       90       100      975       5
187    2  285      2  72 Female       2       70        90      463      20
188    3  259      1  58   Male       0       90        80     1300       8
189   15  110      2  64   Male       1       80        60     1025      12
190   22  286      2  53   Male       0       90        90     1225       8
191   16  270      2  72   Male       1       80        90      488      14
192   16   81      2  52   Male       2       60        70     1075      NA
193   12  131      2  50   Male       1       90        80      513      NA
194    1  225      1  64   Male       1       90        80      825      33
195   22  269      2  71   Male       1       90        90     1300      -2
196   12  225      1  70   Male       0      100       100     1175       6
197   32  243      1  63 Female       1       80        90      825       0
198   21  279      1  64   Male       1       90        90       NA       4
199    1  276      1  52 Female       0      100        80      975       0
200   32  135      2  60   Male       1       90        70     1275       0
201   15   79      2  64 Female       1       90        90      488      37
202   22   59      2  73   Male       1       60        60     2200       5
203   32  240      1  63 Female       0       90       100     1025       0
204    3  202      1  50 Female       0      100       100      635       1
205   26  235      1  63 Female       0      100        90      413       0
206   33  105      2  62   Male       2       NA        70       NA      NA
207    5  224      1  55 Female       0       80        90       NA      23
208   13  239      2  50 Female       2       60        60     1025      -3
209   21  237      1  69   Male       1       80        70       NA      NA
210   33  173      1  59 Female       1       90        80       NA      10
211    1  252      1  60 Female       0      100        90      488      -2
212    6  221      1  67   Male       1       80        70      413      23
213   15  185      1  69   Male       1       90        70     1075       0
214   11   92      1  64 Female       2       70       100       NA      31
215   11   13      2  65   Male       1       80        90       NA      10
216   11  222      1  65   Male       1       90        70     1025      18
217   13  192      1  41 Female       1       90        80       NA     -10
218   21  183      2  76   Male       2       80        60      825       7
219   11  211      1  70 Female       2       70        30      131       3
220    2  175      1  57 Female       0       80        80      725      11
221   22  197      1  67   Male       1       80        90     1500       2
222   11  203      1  71 Female       1       80        90     1025       0
223    1  116      2  76   Male       1       80        80       NA       0
224    1  188      1  77   Male       1       80        60       NA       3
225   13  191      1  39   Male       0       90        90     2350      -5
226   32  105      1  75 Female       2       60        70     1025       5
227    6  174      1  66   Male       1       90       100     1075       1
228   22  177      1  58 Female       1       80        90     1060       0</code></pre>
</div>
</div>
</section>
<section id="survival-analysis-with-survival-1" class="slide level2">
<h2>Survival analysis with {survival}</h2>
<div class="cell custom-40-60">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>kaplan_meier <span class="ot">&lt;-</span> <span class="fu">survfit2</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung_data)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>kaplan_meier <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsurvfit</span>() <span class="sc">+</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_confidence_interval</span>() <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_risktable</span>(<span class="at">risktable_stats =</span> <span class="fu">c</span>(<span class="st">"n.risk"</span>, <span class="st">"cum.event"</span>)) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Days"</span>,</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Overall survival probability"</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
<section id="survival-analysis-with-survival-1-output" class="slide level2 output-location-slide"><h2>Survival analysis with {survival}</h2><div class="cell custom-40-60 output-location-slide">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-34-1.png" width="2020"></p>
</figure>
</div>
</div>
</div></section><section id="survival-analysis-with-survival-2" class="slide level2">
<h2>Survival analysis with {survival}</h2>
<ul>
<li>Syntax of a kaplan meier curve with {survival}
<ul>
<li>The <code>time</code> argument is the total follow up time</li>
<li>Alternatively, <code>time</code> can be the start date of the follow up, and <code>time2</code> can be the end date of follow up</li>
<li>The <code>event</code> argument is 1 or 0 if the event occurred or not, respectively</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survfit2</span>(<span class="fu">Surv</span>(<span class="at">time =</span> follow_up_time, <span class="at">event =</span> status) <span class="sc">~</span> group, <span class="at">data =</span> my_dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
</section>
<section id="survival-analysis-with-survival-3" class="slide level2">
<h2>Survival analysis with {survival}</h2>
<ul>
<li><code>survdiff()</code> can be used to perfom a log rank test for differences in survival curves</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex, <span class="at">data =</span> lung_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
survdiff(formula = Surv(time, status) ~ sex, data = lung_data)

             N Observed Expected (O-E)^2/E (O-E)^2/V
sex=Male   138      112     91.6      4.55      10.3
sex=Female  90       53     73.4      5.68      10.3

 Chisq= 10.3  on 1 degrees of freedom, p= 0.001 </code></pre>
</div>
</div>
</section>
<section id="survival-analysis-with-survival-4" class="slide level2">
<h2>Survival analysis with {survival}</h2>
<ul>
<li>For the Cox proportional hazards model there is a similar function, but to which you can add covariates</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>cox_model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex <span class="sc">+</span> ph.ecog <span class="sc">+</span> wt.loss, <span class="at">data =</span> lung_data)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cox_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, status) ~ sex + ph.ecog + wt.loss, 
    data = lung_data)

  n= 213, number of events= 151 
   (15 observations deleted due to missingness)

               coef exp(coef)  se(coef)      z Pr(&gt;|z|)    
sexFemale -0.588819  0.554983  0.174878 -3.367  0.00076 ***
ph.ecog    0.543620  1.722231  0.123701  4.395 1.11e-05 ***
wt.loss   -0.008753  0.991285  0.006497 -1.347  0.17787    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

          exp(coef) exp(-coef) lower .95 upper .95
sexFemale    0.5550     1.8019    0.3939    0.7819
ph.ecog      1.7222     0.5806    1.3514    2.1948
wt.loss      0.9913     1.0088    0.9787    1.0040

Concordance= 0.646  (se = 0.027 )
Likelihood ratio test= 29.05  on 3 df,   p=2e-06
Wald test            = 28.84  on 3 df,   p=2e-06
Score (logrank) test = 29.29  on 3 df,   p=2e-06</code></pre>
</div>
</div>
</section></section>
<section>
<section id="mixed-effects-regression" class="title-slide slide level1 center">
<h1>Mixed effects <br><br>regression</h1>

</section>
<section id="mixed-models-with-lme4" class="slide level2">
<h2>Mixed models with {lme4}</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Reaction time per day (in milliseconds) for subjects in a sleep deprivation study</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>sleepstudy <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 180 × 3
   Reaction  Days Subject
      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  
 1     250.     0 308    
 2     259.     1 308    
 3     251.     2 308    
 4     321.     3 308    
 5     357.     4 308    
 6     415.     5 308    
 7     382.     6 308    
 8     290.     7 308    
 9     431.     8 308    
10     466.     9 308    
# ℹ 170 more rows</code></pre>
</div>
</div>
</section>
<section id="mixed-models-with-lme4-1" class="slide level2">
<h2>Mixed models with {lme4}</h2>
<ul>
<li>Reaction time increased, on average, over time</li>
</ul>
<div class="cell custom-40-60 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sleepstudy <span class="sc">%&gt;%</span> </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Days, Reaction)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_poly_eq</span>(<span class="fu">use_label</span>(</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"eq"</span>, <span class="st">"R2"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-38-1.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="mixed-models-with-lme4-2" class="slide level2">
<h2>Mixed models with {lme4}</h2>
<ul>
<li>Are the results similar across individuals?</li>
</ul>
<div class="cell custom-40-60 columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>sleepstudy <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Days, Reaction)) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Subject, <span class="at">ncol =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-39-1.png" width="2020"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="mixed-models-with-lme4-3" class="slide level2">
<h2>Mixed models with {lme4}</h2>
<ul>
<li>Fitting a mixed model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>mixed_model<span class="ot">&lt;-</span><span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (Days <span class="sc">|</span> Subject), <span class="at">data =</span> sleepstudy)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mixed_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: Reaction ~ Days + (Days | Subject)
   Data: sleepstudy

REML criterion at convergence: 1743.6

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9536 -0.4634  0.0231  0.4634  5.1793 

Random effects:
 Groups   Name        Variance Std.Dev. Corr
 Subject  (Intercept) 612.10   24.741       
          Days         35.07    5.922   0.07
 Residual             654.94   25.592       
Number of obs: 180, groups:  Subject, 18

Fixed effects:
            Estimate Std. Error t value
(Intercept)  251.405      6.825  36.838
Days          10.467      1.546   6.771

Correlation of Fixed Effects:
     (Intr)
Days -0.138</code></pre>
</div>
</div>
</section>
<section id="mixed-models-with-lme4-4" class="slide level2">
<h2>Mixed models with {lme4}</h2>
<ul>
<li>Global structure of a mixed models formula
<ul>
<li>with FE = Fixed-effects and RE = Random-effects</li>
</ul>
<div class="sourceCode" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>outcome <span class="sc">~</span> FEexpr <span class="sc">+</span> (REexpr1<span class="sc">|</span> factor1)<span class="sc">+</span> (REexpr2<span class="sc">|</span> factor2) <span class="sc">+</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li>Check the <a href="https://cran.r-project.org/web/packages/lme4/index.html">documentation</a> of the lme4 package for additional info</li>
</ul>
</section>
<section id="mixed-models-with-lme4-5" class="slide level2">
<h2>Mixed models with {lme4}</h2>
<ul>
<li>Reporting the findings</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(mixed_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear mixed model (estimated using REML and nloptwrap optimizer)
to predict Reaction with Days (formula: Reaction ~ Days). The model included
Days as random effects (formula: ~Days | Subject). The model's total
explanatory power is substantial (conditional R2 = 0.80) and the part related
to the fixed effects alone (marginal R2) is of 0.28. The model's intercept,
corresponding to Days = 0, is at 251.41 (95% CI [237.94, 264.87], t(174) =
36.84, p &lt; .001). Within this model:

  - The effect of Days is statistically significant and positive (beta = 10.47,
95% CI [7.42, 13.52], t(174) = 6.77, p &lt; .001; Std. beta = 0.54, 95% CI [0.38,
0.69])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section></section>
<section>
<section id="reporting-model-outputs-with-report" class="title-slide slide level1 center">
<h1>Reporting <br><br> model outputs<br><br> with {report}</h1>

</section>
<section id="t-test" class="slide level2">
<h2>t-test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#t-test</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> women<span class="sc">$</span>height<span class="sc">*</span><span class="fl">2.54</span>, <span class="at">mu =</span> <span class="dv">180</span>, </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">alternative =</span> <span class="st">"two.sided"</span>,<span class="at">paired =</span> F)<span class="sc">%&gt;%</span> </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Effect sizes were labelled following Cohen's (1988) recommendations.

The One Sample t-test testing the difference between women$height * 2.54 (mean
= 165.10) and mu = 180 suggests that the effect is negative, statistically
significant, and large (difference = -14.90, 95% CI [158.81, 171.39], t(14) =
-5.08, p &lt; .001; Cohen's d = -1.31, 95% CI [-2.00, -0.60])</code></pre>
</div>
</div>
</section>
<section id="linear-model" class="slide level2">
<h2>Linear Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#LM</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diastolic <span class="sc">~</span> ., <span class="at">data =</span> bp_dataset_mock) <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict diastolic with id,
age, weight, systolic and mock (formula: diastolic ~ id + age + weight +
systolic + mock). The model explains a statistically significant and
substantial proportion of variance (R2 = 0.51, F(6, 291) = 50.46, p &lt; .001,
adj. R2 = 0.50). The model's intercept, corresponding to id = 0, age = 0,
weight = 0, systolic = 0 and mock = High, is at 24.78 (95% CI [17.44, 32.12],
t(291) = 6.64, p &lt; .001). Within this model:

  - The effect of id is statistically non-significant and negative (beta =
-1.56e-04, 95% CI [-7.61e-04, 4.49e-04], t(291) = -0.51, p = 0.613; Std. beta =
-0.02, 95% CI [-0.10, 0.06])
  - The effect of age is statistically significant and negative (beta = -0.10,
95% CI [-0.17, -0.03], t(291) = -2.92, p = 0.004; Std. beta = -0.14, 95% CI
[-0.24, -0.05])
  - The effect of weight is statistically significant and positive (beta = 0.13,
95% CI [0.06, 0.20], t(291) = 3.60, p &lt; .001; Std. beta = 0.15, 95% CI [0.07,
0.24])
  - The effect of systolic is statistically significant and positive (beta =
0.40, 95% CI [0.35, 0.46], t(291) = 13.95, p &lt; .001; Std. beta = 0.71, 95% CI
[0.61, 0.81])
  - The effect of mock [Low] is statistically non-significant and negative (beta
= -1.42, 95% CI [-3.81, 0.98], t(291) = -1.16, p = 0.245; Std. beta = -0.11,
95% CI [-0.31, 0.08])
  - The effect of mock [Medium] is statistically significant and negative (beta =
-3.22, 95% CI [-5.80, -0.64], t(291) = -2.45, p = 0.015; Std. beta = -0.26, 95%
CI [-0.47, -0.05])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="generalized-linear-model" class="slide level2">
<h2>Generalized Linear Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#GLM</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>logit_model <span class="sc">%&gt;%</span> <span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a logistic model (estimated using ML) to predict status with age,
sex, ecog and meal_cal (formula: status ~ age + sex + ecog + meal_cal). The
model's explanatory power is weak (Tjur's R2 = 0.12). The model's intercept,
corresponding to age = 0, sex = 1, ecog = 0 and meal_cal = 0, is at -0.72 (95%
CI [-3.73, 2.26], p = 0.635). Within this model:

  - The effect of age is statistically non-significant and positive (beta = 0.02,
95% CI [-0.02, 0.06], p = 0.296; Std. beta = 0.20, 95% CI [-0.18, 0.58])
  - The effect of sex [2] is statistically significant and negative (beta =
-1.00, 95% CI [-1.75, -0.27], p = 0.007; Std. beta = -1.00, 95% CI [-1.75,
-0.27])
  - The effect of ecog is statistically significant and positive (beta = 0.76,
95% CI [0.24, 1.30], p = 0.005; Std. beta = 0.56, 95% CI [0.18, 0.96])
  - The effect of meal cal is statistically non-significant and positive (beta =
1.77e-04, 95% CI [-7.66e-04, 1.18e-03], p = 0.719; Std. beta = 0.07, 95% CI
[-0.31, 0.47])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald z-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="unlocking-the-power-of-programming" class="slide level2">
<h2>Unlocking the power of programming</h2>
<div class="question">
<p>What if you wanted to explore 2, or 5, or 50 models? Would you have to write them all manually? <br> e.g.&nbsp; <br> “diastolic ~ age”, <br> “diastolic ~ age + weight”, <br> “diastolic ~ age + weight + mock”</p>
</div>
</section>
<section id="enter-loops" class="slide level2">
<h2>Enter… Loops</h2>
<div class="cell scrolling-600">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First, create a vector with the desired model formulas</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"diastolic ~ age"</span>,</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"diastolic ~ age + weight"</span>,</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"diastolic ~ age + weight + mock"</span>)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co">#For each model in the "formulas" vector, do something...</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> formulas) {</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  model_x <span class="ot">&lt;-</span> <span class="fu">lm</span>(i, <span class="at">data =</span> bp_dataset_mock) <span class="co">#Create the model</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(broom<span class="sc">::</span><span class="fu">tidy</span>(model_x)) <span class="co">#Print the output</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">ggcoefstats</span>(model_x, <span class="at">exclude.intercept =</span> T)) <span class="co">#Plot the coefficients</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section><section id="enter-loops-output" class="slide level2 output-location-slide"><h2>Enter… Loops</h2><div class="cell scrolling-600 output-location-slide">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic   p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)   74.1      1.97       37.5  6.59e-115
2 age            0.184    0.0407      4.52 9.11e-  6</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-45-1.png" width="2020"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   57.5      3.58       16.1  4.05e-42
2 age            0.163    0.0388      4.19 3.64e- 5
3 weight         0.247    0.0454      5.44 1.15e- 7</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-45-2.png" width="2020"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)   58.8      3.62      16.2   8.97e-43
2 age            0.154    0.0383     4.01  7.68e- 5
3 weight         0.260    0.0448     5.80  1.72e- 8
4 mockLow       -0.423    1.56      -0.270 7.87e- 1
5 mockMedium    -5.29     1.68      -3.16  1.76e- 3</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="05-stats_files/figure-revealjs/unnamed-chunk-45-3.png" width="2020"></p>
</figure>
</div>
</div>
</div></section></section>
<section id="section-1" class="title-slide slide level1 center">
<h1></h1>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="../images/logo.png" class="quarto-figure quarto-figure-center" style="width:60.0%"></p>
</figure>
</div>

<p><img src="../images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://github.com/c-matos">Carlos Matos</a> // ISPUP::R4HEADS(2023)</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="../site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'multiplex': {"secret":null,"id":"854a9cd337c7cfed","url":"https://reveal-multiplex.glitch.me/"},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealPointer, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                div.style.left = 0;
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
            // Handle positioning of the toggle
        window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
        );
        function throttle(fn, ms) {
        let throttle = false;
        let timer;
          return (...args) => {
            if(!throttle) { // first call gets through
                fn.apply(this, args);
                throttle = true;
            } else { // all the others get throttled
                if(timer) clearTimeout(timer); // cancel #2
                timer = setTimeout(() => {
                  fn.apply(this, args);
                  timer = throttle = false;
                }, ms);
            }
          };
        }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>